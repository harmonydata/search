"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2649],{42649:(e,t,o)=>{o.d(t,{AV:()=>h,Dd:()=>r,Hu:()=>n,Pn:()=>c,Qf:()=>l,U4:()=>g,Y3:()=>d,dh:()=>u,v5:()=>i,w3:()=>s});let a="https://harmonydataweaviate.azureedge.net";async function r(){let e=await fetch("".concat(a,"/discover/aggregate"),{method:"GET"});if(!e.ok){let t=await e.text();throw console.error("fetchAggregateFilters error. Status:",e.status,"Response:",t),Error("Failed to fetch aggregate filters")}let t=await e.json();window.__lastAggregateResponse=t,console.log("Aggregate API response cached in window.__lastAggregateResponse for debugging"),console.log("Aggregate response:",{aggregationKeys:Object.keys(t.aggregations||{}),sampleKeys:Object.keys(t.aggregations||{}).slice(0,3).map(e=>({key:e,value:t.aggregations[e]}))});let o=t.aggregations||{};return Object.keys(o).map(e=>{let t;let a=o[e];if(["num_sweeps","num_variables","sample_size","duration_years","age_lower","age_upper","start_year","end_year"].includes(e)&&"object"==typeof a&&!Array.isArray(a)&&void 0!==a.minimum&&void 0!==a.maximum){let e=Math.floor(a.minimum),o=Math.ceil(a.maximum),r=[],n=Math.min(100,o-e+1),s=(o-e)/(n-1);for(let t=0;t<n;t++)r.push(String(Math.round(e+t*s)));t=r}else t=Object.keys(a);return{id:e,label:e.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" "),options:t,frequencies:"object"!=typeof a||Array.isArray(a)?void 0:a}})}async function n(e,t){var o,r;let n,s,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:40,l=!(arguments.length>4)||void 0===arguments[4]||arguments[4],g=arguments.length>5?arguments[5]:void 0,d=arguments.length>6?arguments[6]:void 0,h=arguments.length>7?arguments[7]:void 0,u=arguments.length>8?arguments[8]:void 0,f=arguments.length>9?arguments[9]:void 0,p=t&&Object.keys(t).length>0;if(!e&&!p)return{results:[],aggregations:{},num_hits:0};let _=e&&""!==e.trim()?e.trim():"",w=d&&d.length>0&&!l,m=l?"search2":"search",v="".concat(a,"/discover/").concat(m);if(w){n=v;let e={query:[_],num_results:c},o=void 0!==h?h:(i-1)*c;e.offset=o,void 0!==g&&(e.alpha=g),e.top_level_ids_seen_so_far=d,t&&Object.entries(t).forEach(t=>{let[o,a]=t;a.length>0&&(o.endsWith("_min")||o.endsWith("_max")?e[o]=parseInt(a[0],10):e[o]=a)}),void 0!==u&&(e.return_variables_within_parent=u),void 0!==f&&(e.max_vector_distance=f),s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)},console.log("Using POST request for pagination with body:",{query:[_],topLevelIdsCount:d.length,offset:o,endpoint:m})}else{let e=new URLSearchParams;void 0!==g&&e.set("alpha",g.toString()),e.append("query",_);let o=void 0!==h?h:(i-1)*c;e.set("num_results",c.toString()),e.set("offset",o.toString());let a={};if(t)for(let o in t)if(o.endsWith("_min")||o.endsWith("_max")){let r=o.replace(/_(min|max)$/,"");a[r]||(a[r]={}),o.endsWith("_min")?a[r].min=t[o][0]:a[r].max=t[o][0],e.append(o,t[o][0])}else t[o].forEach(t=>{e.append(o,t)});void 0!==u&&e.set("return_variables_within_parent",u.toString()),void 0!==f&&e.set("max_vector_distance",f.toString()),n="".concat(v,"?").concat(e.toString()),s={method:"GET"},Object.keys(a).length>0&&console.log("Numeric range parameters:",a),console.log("Using GET request:",n)}let y=await fetch(n,s);if(!y.ok)throw console.error("Search API error:",y.status,await y.text()),Error("Search API request failed");let S=await y.json();return window.__lastSearchResponse=S,console.log("Search API response cached in window.__lastSearchResponse for debugging"),console.log("Search results:",{totalHits:S.num_hits,resultCount:(null===(o=S.results)||void 0===o?void 0:o.length)||0,firstResult:null===(r=S.results)||void 0===r?void 0:r[0],aggregations:Object.keys(S.aggregations||{}),endpoint:m,method:w?"POST":"GET",hybridWeight:g}),{results:S.results||[],aggregations:S.aggregations||{},num_hits:S.num_hits,top_level_ids_seen_so_far:S.top_level_ids_seen_so_far||[],next_page_offset:S.next_page_offset}}async function s(e,t,o,r){let n=new URLSearchParams,s=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)||/^[0-9a-f]{32}$/i.test(e);s?n.set("uuid",e):n.set("slug",e),t&&t.trim()&&n.set("query",t.trim()),void 0!==o&&n.set("alpha",o.toString()),void 0!==r&&n.set("max_vector_distance",r.toString());let i="".concat(a,"/discover/lookup?").concat(n.toString()),c=await fetch(i);if(!c.ok&&s&&404===c.status){console.log("UUID lookup failed for ".concat(e,", trying as slug..."));let n=new URLSearchParams;n.set("slug",e),t&&t.trim()&&n.set("query",t.trim()),void 0!==o&&n.set("alpha",o.toString()),void 0!==r&&n.set("max_vector_distance",r.toString());let s="".concat(a,"/discover/lookup?").concat(n.toString()),i=await fetch(s);if(i.ok){let e=await i.json();return window.__lastLookupResponse=e,e.results[0]}}if(!c.ok)throw console.error("Failed to fetch result by UUID:",c.statusText),Error("Failed to fetch result by UUID: ".concat(c.statusText));let l=await c.json();return window.__lastLookupResponse=l,l.results[0]}async function i(e){let t=function(e){if(!e||"string"!=typeof e)return e;if(e.endsWith(")")){let t=(e.match(/\(/g)||[]).length,o=(e.match(/\)/g)||[]).length;if(o>t){let a=o-t,r=e;for(let e=0;e<a;e++)r.endsWith(")")&&(r=r.slice(0,-1));return r!==e&&console.log('Cleaned URL: "'.concat(e,'" -> "').concat(r,'" (removed ').concat(a," extra closing brackets)")),r}}return e}(e),o=await fetch("https://harmonydata.azureedge.net/api/ogData?url=".concat(encodeURIComponent(t)));if(!o.ok)throw Error("Failed to fetch OpenGraph data");return o.json()}async function c(){let e=await fetch("".concat(a,"/info/version"));if(!e.ok)throw console.error("Failed to fetch version info:",e.statusText),Error("Failed to fetch version info");let t=await e.json();return window.__lastVersionResponse=t,console.log("Version API response cached in window.__lastVersionResponse for debugging"),t}async function l(){let e=await fetch("".concat(a,"/info/get-keyword-search-terms"));if(!e.ok)throw console.error("Failed to fetch keyword phrases:",e.statusText),Error("Failed to fetch keyword phrases");let t=await e.json();return window.__lastKeywordPhrasesResponse=t,console.log("Keyword phrases API response cached in window.__lastKeywordPhrasesResponse for debugging"),t}async function g(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URLSearchParams;Object.entries(e).forEach(e=>{let[o,a]=e;a.length>0&&a.forEach(e=>{t.append(o,e)})});let o=await fetch("".concat(a,"/discover/aggregate?").concat(t.toString()),{headers:{accept:"application/json"}});if(!o.ok)throw Error("Failed to fetch aggregate data");return o.json()}async function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URLSearchParams;Object.entries(e).forEach(e=>{let[o,a]=e;a.length>0&&a.forEach(e=>{t.append(o,e)})});let o=await fetch("".concat(a,"/discover/get_numeric_values?").concat(t.toString()),{headers:{accept:"application/json"}});if(!o.ok)throw Error("Failed to fetch numeric values");return o.json()}async function h(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URLSearchParams;Object.entries(e).forEach(e=>{let[o,a]=e;a.length>0&&a.forEach(e=>{t.append(o,e)})});let o=await fetch("".concat(a,"/discover/get_word_cloud?").concat(t.toString()),{headers:{accept:"application/json"}});if(!o.ok)throw Error("Failed to fetch word cloud data");return o.json()}async function u(){let e=await fetch("".concat(a,"/discover/sources"),{headers:{accept:"application/json"}});if(!e.ok)throw Error("Failed to fetch sources data");return e.json()}}}]);