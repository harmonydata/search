(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3121],{83686:()=>{},32383:()=>{},86453:(e,t,o)=>{"use strict";o.d(t,{A:()=>x});var a=o(95155),n=o(78416),i=o(36417),l=o(9561),s=o(68998),r=o(47821),d=o(27753),c=o(26214),u=o(22282),h=o(2743),g=o(6327),p=o(2599);function x(e){let{open:t,onClose:o,data:x,title:m="Debug Data"}=e,f=()=>{navigator.clipboard.writeText(JSON.stringify(x,null,2))};return(0,a.jsxs)(n.A,{open:t,onClose:o,maxWidth:"lg",fullWidth:!0,sx:{"& .MuiDialog-paper":{maxHeight:"90vh",height:"90vh"}},children:[(0,a.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:1},children:[(0,a.jsx)(l.A,{variant:"h6",component:"div",children:m}),(0,a.jsxs)(s.default,{children:[(0,a.jsx)(r.A,{onClick:f,size:"small",sx:{mr:1},title:"Copy JSON to clipboard",children:(0,a.jsx)(h.A,{fontSize:"small"})}),(0,a.jsx)(r.A,{onClick:o,size:"small",children:(0,a.jsx)(g.A,{fontSize:"small"})})]})]}),(0,a.jsx)(d.A,{dividers:!0,sx:{p:0,height:"100%"},children:t&&(0,a.jsx)(s.default,{sx:{height:"100%",overflow:"auto","& .w-json-view-container":{backgroundColor:"#fafafa",fontSize:"13px",fontFamily:'"SF Mono", Monaco, "Cascadia Code", "Roboto Mono", Consolas, "Courier New", monospace'}},children:(0,a.jsx)(p.Ay,{value:x,collapsed:2,displayObjectSize:!0,displayDataTypes:!0,enableClipboard:!0,style:{backgroundColor:"#fafafa",padding:"16px"}})})}),(0,a.jsxs)(c.A,{children:[(0,a.jsx)(u.A,{onClick:f,startIcon:(0,a.jsx)(h.A,{}),children:"Copy JSON"}),(0,a.jsx)(u.A,{onClick:o,variant:"contained",children:"Close"})]})]})}},65776:(e,t,o)=>{"use strict";o.d(t,{A:()=>c});var a=o(95155),n=o(64665),i=o(68998),l=o(9561),s=o(5565),r=o(3485),d=o(12115);function c(e){let{name:t,url:o,logo:c,inactive:u,compact:h}=e,[g,p]=(0,d.useState)(c),[x,m]=(0,d.useState)(!1);(0,d.useEffect)(()=>{console.log('Resolving logo for organization: "'.concat(t,'"'));try{let e=(0,r.sM)(t,c);console.log('Resolved logo for organization "'.concat(t,'":'),e),p(e),m(!1)}catch(e){console.error('Error resolving logo for organization "'.concat(t,'":'),e),p(void 0)}},[t,c]);let f=g&&g.length>0&&!x;return(0,a.jsxs)(n.A,{elevation:0,sx:{display:"flex",borderRadius:"16px",overflow:"hidden",width:h?"220px":"280px",height:h?"75px":"85px",flexShrink:0,border:"1px solid",borderColor:"grey.200",cursor:o?"pointer":"default",transition:"all 0.2s",opacity:u?.5:1,"&:hover":o?{boxShadow:2,borderColor:"primary.main"}:{}},onClick:()=>{o&&window.open(o,"_blank","noopener,noreferrer")},children:[(0,a.jsx)(i.default,{sx:{flex:1,bgcolor:"rgba(0,0,0,0.03)",p:2,display:"flex",flexDirection:"column",justifyContent:"center"},children:(0,a.jsx)(l.A,{sx:{fontWeight:500,fontSize:h?"0.8rem":"0.9rem",lineHeight:1.2,overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",maxHeight:"3.9em",wordBreak:"break-word",paddingBottom:"1px"},children:t})}),f&&(0,a.jsx)(i.default,{sx:{width:"30%",bgcolor:"white",display:"flex",alignItems:"center",justifyContent:"center",p:1,borderLeft:"1px solid",borderColor:"grey.200"},children:(0,a.jsx)(s.default,{src:g,alt:t,width:h?40:50,height:h?40:50,style:{objectFit:"contain"},onError:()=>{console.error('Error loading image for organization "'.concat(t,'" from path: ').concat(g)),m(!0)},unoptimized:!0})})]})}},53452:(e,t,o)=>{"use strict";o.d(t,{A:()=>n});var a=o(22282);let n=(0,o(89142).Ay)(a.A,{shouldForwardProp:e=>"chipVariant"!==e})(e=>{let{theme:t,chipVariant:o="primary",onClick:a=()=>{}}=e;return{onClick:a,borderRadius:8,textTransform:"none",padding:"0 16px",height:32,minHeight:32,fontSize:"0.875rem",fontWeight:500,whiteSpace:"nowrap",lineHeight:1,..."primary"===o&&{backgroundColor:t.palette.primary.main,color:t.palette.primary.contrastText,"&:hover":{backgroundColor:t.palette.primary.dark}},..."secondary"===o&&{backgroundColor:t.palette.secondary.main,color:t.palette.secondary.contrastText,"&:hover":{backgroundColor:t.palette.secondary.dark}},..."dark"===o&&{backgroundColor:"#444653",color:"#FFFFFF","&:hover":{backgroundColor:"#363742"}}}})},69110:(e,t,o)=>{"use strict";o.d(t,{A:()=>er});var a=o(95155),n=o(68998),i=o(96854),l=o(9561),s=o(47821),r=o(35256),d=o(5565),c=o(90675),u=o(20687),h=o(52488),g=o(32645),p=o(12115),x=o(53452),m=o(64665),f=o(3485);function v(e){let{name:t,url:o,logo:i}=e,[s,r]=(0,p.useState)(i),[c,u]=(0,p.useState)(!1);(0,p.useEffect)(()=>{console.log('Resolving logo for data catalog: "'.concat(t,'"'));try{let e=(0,f.sM)(t,i);console.log('Resolved logo for data catalog "'.concat(t,'":'),e),r(e),u(!1)}catch(e){console.error('Error resolving logo for data catalog "'.concat(t,'":'),e),r(void 0)}},[t,i]);let h=s&&s.length>0&&!c;return(0,a.jsxs)(m.A,{elevation:0,sx:{display:"flex",borderRadius:"16px",overflow:"hidden",width:"280px",height:"80px",flexShrink:0,border:"1px solid",borderColor:"grey.200",cursor:o?"pointer":"default",transition:"all 0.2s","&:hover":o?{boxShadow:2,borderColor:"primary.main"}:{}},onClick:()=>{o&&window.open(o,"_blank","noopener,noreferrer")},children:[(0,a.jsx)(n.default,{sx:{flex:1,bgcolor:"rgba(0,0,0,0.03)",p:2,display:"flex",flexDirection:"column",justifyContent:"center"},children:(0,a.jsx)(l.A,{sx:{fontWeight:500,fontSize:"0.9rem",lineHeight:1.2,overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",maxHeight:"3.7em",wordBreak:"break-word"},children:t})}),h&&(0,a.jsx)(n.default,{sx:{width:"30%",bgcolor:"white",display:"flex",alignItems:"center",justifyContent:"center",p:1,borderLeft:"1px solid",borderColor:"grey.200"},children:(0,a.jsx)(d.default,{src:s,alt:t,width:50,height:50,style:{objectFit:"contain"},onError:()=>{console.error('Error loading image for data catalog "'.concat(t,'" from path: ').concat(s)),u(!0)},unoptimized:!0})})]})}var b=o(65776),y=o(51857),j=o(67247),C=o(26536),A=o(50914),w=o(57165),S=o(53326),k=o(72926),R=o(66917),_=o(4918),I=o(41983),E=o(2091),D=o(60391),z=o(78416),N=o(36417),H=o(27753),O=o(10319),F=o(10358),W=o(64364),U=o(71569),L=o(689),M=o(48694),B=o(7660);function T(e){let{variables:t,studyName:o,downloadAnchorEl:i,onDownloadClick:l,onDownloadClose:r}=e,d=(0,p.useRef)(null),c=(0,p.useRef)(null),[u,h]=(0,p.useState)(!1);console.log("variables passed:",t),(0,p.useEffect)(()=>{if(customElements.get("harmony-export"))return;let e=document.createElement("script");return e.src="/app/js/harmony-export.js",e.async=!0,document.body.appendChild(e),()=>{document.body.contains(e)&&document.body.removeChild(e)}},[]);let g=[{field:"description",headerName:"Description / Code",flex:2,valueGetter:(e,t)=>(t.description||t.name)+(t.description&&t.name?" ("+t.name+")":""),sortable:!0},{field:"options",headerName:"Response Options",flex:1,valueGetter:(e,t)=>t.options&&Array.isArray(t.options)?t.options.join(" / "):"",sortable:!0}],x=t.filter(e=>e.name||e.description).map((e,t)=>({id:e.uuid||e.name||t,...e})),m=(0,C.b)();(0,p.useEffect)(()=>{let e=setTimeout(()=>{m.current&&h(!0)},200);return()=>clearTimeout(e)},[m]);let f=()=>{let e=m.current;if(!e||!u)return[];try{let t=e.getSelectedRows();return t?Array.from(t.values()):[]}catch(e){return console.warn("Failed to get selected items:",e),[]}},v=()=>f().length,b=()=>{let e=m.current;if(!e||!u)return!1;try{let t=e.getSelectedRows();return t&&"number"==typeof t.size&&t.size>0}catch(e){return!1}},y=(0,p.useCallback)(()=>{if(!d.current||!u)return;let e=f();if(d.current.innerHTML="",0===e.length)return;console.log("selectedItems:",e);let t=e.map((e,t)=>({question_no:e.description?e.name:t,question_text:e.description||e.name})),a=document.createElement("harmony-export");a.size="32px",a.instrument_name="".concat(o||"Selected Variables"," from harmonydata.ac.uk/discover"),a.questions=t,d.current.appendChild(a)},[u,o]);(0,p.useEffect)(()=>{if(!u||!m.current)return;let e=m.current.subscribeEvent("rowSelectionChange",()=>{y()});return()=>{e()}},[u,y]);let j=()=>{null==r||r()},z=()=>{let e;let t=m.current;if(!t||!u)return[];try{e=t.getSelectedRows()}catch(t){e=null}return(e&&"number"==typeof e.size&&e.size>0&&e?Array.from(e.values()):(()=>{let e;try{e=t.getRowModels()}catch(t){e=null}return e?Array.from(e.values()):[]})()).map((e,t)=>({question_no:e.description?e.name:t,question_text:e.description||e.name,response_options:e.options&&Array.isArray(e.options)?e.options.join(" / "):""}))};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.default,{sx:{height:"100%",minHeight:400},children:x.length>0&&(0,a.jsx)(A.z,{apiRef:m,paginationMode:"server",rows:x,columns:g,checkboxSelection:!0,sortModel:[{field:"score",sort:"desc"}],getRowClassName:e=>e.row.matched?"matched-row":"",sx:{background:"white",borderRadius:2,fontSize:14,height:"100%","& .matched-row":{backgroundColor:"#fffae4","&:hover":{backgroundColor:"#fff8d1"}}},hideFooter:!0,pageSizeOptions:[20,50,100],showToolbar:!0,slots:{toolbar:()=>(0,a.jsxs)(n.default,{sx:{display:"flex",alignItems:"center",gap:2,p:1,mr:2},children:[(0,a.jsx)(w.e,{expanded:!0,style:{width:"100%"},children:(0,a.jsx)(S.X,{placeholder:"Search within variables",style:{background:"white",borderRadius:192,fontSize:14,margin:15,width:"calc(100% - 15px)",height:"auto"}})}),(0,a.jsx)(k.A,{title:"Harmonise selected items",children:(0,a.jsx)(s.A,{size:"small",sx:{width:40,height:40},children:(0,a.jsx)(n.default,{ref:d,sx:{display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20}})})}),(0,a.jsx)(k.A,{title:b()?"Download ".concat(v()," selected questions"):"Download all questions",children:(0,a.jsx)(s.A,{ref:c,size:"small",onClick:l,sx:{width:40,height:40},children:(0,a.jsx)(O.A,{size:30})})})]})}})}),(0,a.jsx)(R.Ay,{open:!!i,anchorEl:i,onClose:j,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"center"},children:(0,a.jsxs)(_.A,{sx:{width:200},children:[(0,a.jsxs)(I.Ay,{onClick:()=>{let e=new Blob([JSON.stringify(z(),null,2)],{type:"application/json"}),t=URL.createObjectURL(e),o=document.createElement("a");o.href=t,o.download="questions.json",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(t),j()},sx:{cursor:"pointer"},children:[(0,a.jsx)(E.A,{children:(0,a.jsx)(F.A,{size:20})}),(0,a.jsx)(D.A,{primary:"Download as JSON"})]}),(0,a.jsxs)(I.Ay,{onClick:()=>{let e=new Blob([[["Question Number","Question Text","Response Options"],...z().map(e=>[e.question_no,e.question_text,e.response_options])].map(e=>e.map(e=>'"'.concat(e,'"')).join(",")).join("\n")],{type:"text/csv"}),t=URL.createObjectURL(e),o=document.createElement("a");o.href=t,o.download="questions.csv",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(t),j()},sx:{cursor:"pointer"},children:[(0,a.jsx)(E.A,{children:(0,a.jsx)(W.A,{size:20})}),(0,a.jsx)(D.A,{primary:"Download as CSV"})]}),(0,a.jsxs)(I.Ay,{onClick:()=>{let e=z(),t=B.Wp.json_to_sheet(e),o=B.Wp.book_new();B.Wp.book_append_sheet(o,t,"Questions");let a=new Blob([B.M9(o,{bookType:"xlsx",type:"array"})],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),n=URL.createObjectURL(a),i=document.createElement("a");i.href=n,i.download="questions.xlsx",document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(n),j()},sx:{cursor:"pointer"},children:[(0,a.jsx)(E.A,{children:(0,a.jsx)(U.A,{size:20})}),(0,a.jsx)(D.A,{primary:"Download as Excel"})]})]})})]})}function V(e){let{variables:t,studyName:o}=e,[i,r]=(0,p.useState)(!1),d=(0,p.useRef)(null),[c,u]=(0,p.useState)(null),h=()=>{u(null),r(!1)},g=(0,a.jsx)(T,{variables:t,studyName:o,downloadAnchorEl:c,onDownloadClick:e=>{console.log("handleDownloadClick",e.currentTarget),u(d.current)},onDownloadClose:()=>{u(null)}});return i?(0,a.jsxs)(z.A,{ref:d,open:!0,onClose:h,maxWidth:"xl",fullWidth:!0,sx:{"& .MuiDialog-paper":{height:"90vh",maxHeight:"90vh"}},children:[(0,a.jsxs)(N.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:1},children:[(0,a.jsxs)(l.A,{variant:"h6",children:["Variables - ",o||"Study"]}),(0,a.jsx)(s.A,{onClick:h,size:"small",sx:{color:"text.secondary"},children:(0,a.jsx)(L.A,{size:20})})]}),(0,a.jsx)(H.A,{sx:{p:0,overflow:"hidden"},children:(0,a.jsx)(n.default,{sx:{height:"100%","& .MuiDataGrid-root":{borderRadius:0,maxHeight:"none",height:"100%"}},children:g})})]}):(0,a.jsxs)(n.default,{ref:d,sx:{position:"relative"},children:[(0,a.jsx)(n.default,{sx:{position:"absolute",top:8,right:8,zIndex:10,backgroundColor:"rgba(255, 255, 255, 0.9)",borderRadius:1},children:(0,a.jsx)(k.A,{title:"Open in large view",children:(0,a.jsx)(s.A,{size:"small",onClick:()=>{u(null),r(!0)},children:(0,a.jsx)(M.A,{size:20})})})}),(0,a.jsx)(n.default,{sx:{"& .MuiDataGrid-root":{height:450,borderRadius:2}},children:g})]})}o(67699);var P=o(22282),K=o(90662),G=o(28222),J=o(65330),q=o(26214),X=o(2743),Q=o(6327),Y=o(51644),Z=o(86453);function $(e){let{open:t,onClose:o,title:i,originalSearchResult:r,lookupData:d,finalProcessedData:c}=e,[u,h]=(0,p.useState)(!1),[g,x]=(0,p.useState)(null),[m,f]=(0,p.useState)(""),v=()=>{navigator.clipboard.writeText(JSON.stringify({originalSearchResult:r,lookupData:d,finalProcessedData:c},null,2))},b=(e,t)=>{x(e),f(t),h(!0)},y=e=>{let{data:t,label:o}=e;return t?(0,a.jsxs)(n.default,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[(0,a.jsxs)(l.A,{variant:"body2",children:[(0,a.jsxs)("strong",{children:[o,":"]})," ",(e=>{var t,o;if(!e||"object"!=typeof e)return"Invalid data";let a=Object.keys(e).length,n=e.title||(null===(t=e.dataset_schema)||void 0===t?void 0:t.name)||(null===(o=e.extra_data)||void 0===o?void 0:o.name)||e.name||"Unnamed";return"".concat(n," (").concat(a," top-level properties)")})(t)]}),(0,a.jsx)(P.A,{size:"small",variant:"outlined",onClick:()=>b(t,"".concat(i," - ").concat(o)),sx:{ml:2},children:"View JSON"})]}):(0,a.jsxs)(l.A,{variant:"body2",color:"text.secondary",sx:{fontStyle:"italic"},children:["No ",o.toLowerCase()," data available"]})};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(z.A,{open:t,onClose:o,maxWidth:"md",fullWidth:!0,sx:{"& .MuiDialog-paper":{maxHeight:"80vh"}},children:[(0,a.jsxs)(N.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:1},children:[(0,a.jsxs)(l.A,{variant:"h6",component:"div",children:["Debug Data: ",i]}),(0,a.jsxs)(n.default,{children:[(0,a.jsx)(s.A,{onClick:v,size:"small",sx:{mr:1},title:"Copy all data to clipboard",children:(0,a.jsx)(X.A,{fontSize:"small"})}),(0,a.jsx)(s.A,{onClick:o,size:"small",children:(0,a.jsx)(Q.A,{fontSize:"small"})})]})]}),(0,a.jsx)(H.A,{dividers:!0,sx:{p:3},children:t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.A,{variant:"subtitle1",gutterBottom:!0,sx:{mb:3},children:"Data Pipeline Overview"}),(0,a.jsxs)(n.default,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,a.jsxs)(K.A,{defaultExpanded:!1,children:[(0,a.jsx)(G.A,{expandIcon:(0,a.jsx)(Y.A,{}),children:(0,a.jsx)(l.A,{variant:"subtitle2",sx:{fontWeight:600},children:"1. Original Search Result"})}),(0,a.jsxs)(J.A,{children:[(0,a.jsx)(l.A,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"The raw data returned from the search API when this result was found."}),(0,a.jsx)(y,{data:r,label:"Original Search Result"})]})]}),(0,a.jsxs)(K.A,{defaultExpanded:!1,children:[(0,a.jsx)(G.A,{expandIcon:(0,a.jsx)(Y.A,{}),children:(0,a.jsx)(l.A,{variant:"subtitle2",sx:{fontWeight:600},children:"2. Lookup Data"})}),(0,a.jsxs)(J.A,{children:[(0,a.jsx)(l.A,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"The full data fetched from the lookup API using the UUID from the search result."}),(0,a.jsx)(y,{data:d,label:"Lookup Data"})]})]}),(0,a.jsxs)(K.A,{defaultExpanded:!1,children:[(0,a.jsx)(G.A,{expandIcon:(0,a.jsx)(Y.A,{}),children:(0,a.jsx)(l.A,{variant:"subtitle2",sx:{fontWeight:600},children:"3. Final Processed Data"})}),(0,a.jsxs)(J.A,{children:[(0,a.jsx)(l.A,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"The processed and formatted data that is displayed in the StudyDetail component."}),(0,a.jsx)(y,{data:c,label:"Final Processed Data"})]})]})]}),(0,a.jsx)(n.default,{sx:{mt:3,p:2,bgcolor:"grey.50",borderRadius:1},children:(0,a.jsxs)(l.A,{variant:"caption",color:"text.secondary",children:[(0,a.jsx)("strong",{children:"Data Flow:"})," Original Search Result → Lookup API → Processing & Mapping → StudyDetail Component"]})})]})}),(0,a.jsxs)(q.A,{children:[(0,a.jsx)(P.A,{onClick:v,startIcon:(0,a.jsx)(X.A,{}),children:"Copy All Data"}),(0,a.jsx)(P.A,{onClick:o,variant:"contained",children:"Close"})]})]}),(0,a.jsx)(Z.A,{open:u,onClose:()=>h(!1),data:g,title:m})]})}var ee=o(66656),et=o(48173),eo=o.n(et);function ea(e){let{datasets:t}=e,o=[{field:"title",headerName:"Dataset Name",flex:1,minWidth:300,renderCell:e=>{let t=e.value||"Untitled Dataset",o=e.row.slug,n=e.row.uuid;return o?(0,a.jsx)(ee.A,{component:eo(),href:"/items/".concat(o),underline:"hover",sx:{fontWeight:600,color:"primary.main"},children:t}):n?(0,a.jsx)(ee.A,{component:eo(),href:"/items/".concat(n),underline:"hover",sx:{fontWeight:600,color:"primary.main"},children:t}):(0,a.jsx)(l.A,{variant:"body2",sx:{fontWeight:600},children:t})}},{field:"numVariables",headerName:"Variables",width:120,renderCell:e=>{let t=e.value;return(0,a.jsx)(l.A,{variant:"body2",color:"text.secondary",children:t||"-"})}},{field:"temporalCoverage",headerName:"Time Coverage",width:150,renderCell:e=>{let t=e.value;return(0,a.jsx)(l.A,{variant:"body2",color:"text.secondary",children:t||"-"})}}],i=(0,p.useMemo)(()=>t.map((e,t)=>{var o,a,n,i,l,s,r,d,c;return{id:(null===(o=e.extra_data)||void 0===o?void 0:o.uuid)||t,title:(null===(a=e.dataset_schema)||void 0===a?void 0:a.name)||(null===(n=e.extra_data)||void 0===n?void 0:n.name)||"Untitled Dataset",slug:null===(i=e.extra_data)||void 0===i?void 0:i.slug,uuid:null===(l=e.extra_data)||void 0===l?void 0:l.uuid,numVariables:(null===(s=e.dataset_schema)||void 0===s?void 0:s.number_of_variables)||(null===(r=e.extra_data)||void 0===r?void 0:r.num_variables)||(null===(d=e.extra_data)||void 0===d?void 0:d.number_of_variables),temporalCoverage:null===(c=e.dataset_schema)||void 0===c?void 0:c.temporalCoverage}}),[t]);return(0,a.jsx)(n.default,{sx:{height:"100%",minHeight:200},children:(0,a.jsx)(A.z,{rows:i,columns:o,disableRowSelectionOnClick:!0,sortModel:[{field:"title",sort:"asc"}],sx:{background:"white",borderRadius:2,fontSize:14,height:"100%"},hideFooter:!0,pageSizeOptions:[20,50,100],showToolbar:!0,slots:{toolbar:()=>(0,a.jsx)(n.default,{sx:{display:"flex",alignItems:"center",gap:2,p:1,mr:2},children:(0,a.jsx)(w.e,{expanded:!0,style:{width:"100%"},children:(0,a.jsx)(S.X,{})})})}})})}var en=o(10683),ei=o(54615),el=o(73179),es=o(42649);let er=(0,p.memo)(e=>{var t,o,m,f,C;let{study:A,isDrawerView:w=!1,onTopicClick:S,onInstrumentClick:k,debugData:R,originalSearchResult:_,isLoadingEnhancedData:I=!1}=e,[E,D]=(0,p.useState)(!1),[z,N]=(0,p.useState)(!1),[H,O]=(0,p.useState)(!1),[F,W]=(0,p.useState)(!1),[U,L]=(0,p.useState)(!0),[M,B]=(0,p.useState)(!1),[T,P]=(0,p.useState)(!1),[K,G]=(0,p.useState)(null),[J,q]=(0,p.useState)(A),[X,Q]=(0,p.useState)(I),[Y,Z]=(0,p.useState)(R),{currentUser:ee}=(0,en.A)(),et=J.aiSummary&&J.aiSummary.trim().length>0,eo=U&&et?J.aiSummary:J.description;(0,p.useEffect)(()=>{W(!1)},[J.title,J.image]),(0,p.useEffect)(()=>{O(!1)},[J.title]),(0,p.useEffect)(()=>{(async()=>{if(ee&&J.uuid)try{let e=(0,ei.P)((0,ei.rJ)(el.db,"saved_resources"),(0,ei._M)("uid","==",ee.uid),(0,ei._M)("uuid","==",J.uuid)),t=await (0,ei.GG)(e);if(t.empty)B(!1),G(null);else{let e=t.docs[0];B(!0),G(e.id)}}catch(e){console.error("Error checking if resource is saved:",e)}})()},[ee,J.uuid]);let er=async()=>{if(ee&&J.uuid&&!T){P(!0);try{if(M&&K)await (0,ei.kd)((0,ei.H9)(el.db,"saved_resources",K)),B(!1),G(null);else{var e,t,o,a,n,i,l;let s={title:J.title,description:J.aiSummary||J.description,image:J.image||null,uuid:J.uuid,slug:J.slug||null,resourceType:J.resourceType||null,keywords:J.topics||[],variablesCount:(null===(e=J.allVariables)||void 0===e?void 0:e.length)||(null===(t=J.dataset_schema)||void 0===t?void 0:t.number_of_variables)||(null===(a=J.dataset_schema)||void 0===a?void 0:null===(o=a.variableMeasured)||void 0===o?void 0:o.length)||0,datasetsCount:(null===(n=J.child_datasets)||void 0===n?void 0:n.length)||0,hasDataAvailable:!!(null===(l=J.dataset_schema)||void 0===l?void 0:null===(i=l.includedInDataCatalog)||void 0===i?void 0:i.length),hasFreeAccess:J.hasFreeAccess||!1,hasCohortsAvailable:J.hasCohortsAvailable||!1,uid:ee.uid,created:(0,ei.O5)()};console.log("Saving resource:",s);let r=await (0,ei.gS)((0,ei.rJ)(el.db,"saved_resources"),s);B(!0),G(r.id)}}catch(e){console.error("Error saving/unsaving resource:",e)}finally{P(!1)}}};(0,p.useEffect)(()=>{L(!!et)},[J.title,et]),(0,p.useEffect)(()=>{let e=!1;return async function(){var t;if(I&&(null==_?void 0:null===(t=_.extra_data)||void 0===t?void 0:t.uuid))try{Q(!0);let t=await (0,es.w3)(_.extra_data.uuid,"",.5,.4);!t.variables_which_matched&&_.variables_which_matched&&(t.variables_which_matched=_.variables_which_matched),!t.child_datasets&&_.datasets_which_matched&&(t.child_datasets=_.datasets_which_matched);let o=function(e){var t,o,a,n,i,l,s,r,d,c,u,h,g,p,x,m,f,v,b,y,j,C,A,w,S,k,R,_,I,E,D,z,N;let H=(null===(t=e.dataset_schema)||void 0===t?void 0:t.name)||(null===(o=e.extra_data)||void 0===o?void 0:o.name)||"Untitled Study",O=(null===(a=e.dataset_schema)||void 0===a?void 0:a.description)||(null===(n=e.extra_data)||void 0===n?void 0:n.description)||"",F=(null===(i=e.dataset_schema)||void 0===i?void 0:i.image)||e.image,W=(null===(s=e.dataset_schema)||void 0===s?void 0:null===(l=s.publisher)||void 0===l?void 0:l[0])?{name:e.dataset_schema.publisher[0].name||"Unknown Publisher",url:null===(r=e.dataset_schema.publisher[0])||void 0===r?void 0:r.url,logo:null===(d=e.dataset_schema.publisher[0])||void 0===d?void 0:d.logo}:void 0,U=null===(u=e.dataset_schema)||void 0===u?void 0:null===(c=u.funder)||void 0===c?void 0:c.map(e=>({name:e.name||"Funding Organization",url:null==e?void 0:e.url,logo:null==e?void 0:e.logo})),L=(null===(g=e.extra_data)||void 0===g?void 0:null===(h=g.country_codes)||void 0===h?void 0:h.join(", "))||e.geographic_coverage,M=(null===(p=e.dataset_schema)||void 0===p?void 0:p.temporalCoverage)||e.temporal_coverage,B=null!==(D=null===(x=e.extra_data)||void 0===x?void 0:x.age_lower)&&void 0!==D?D:e.age_lower,T=null!==(z=null===(m=e.extra_data)||void 0===m?void 0:m.age_upper)&&void 0!==z?z:e.age_upper,V=void 0!==B&&void 0!==T?"".concat(B," - ").concat(T," years"):void 0!==B?"".concat(B,"+ years"):void 0!==T?"0 - ".concat(T," years"):void 0,P=(null===(f=e.extra_data)||void 0===f?void 0:f.study_design)||e.study_design||[],K=(null===(v=e.extra_data)||void 0===v?void 0:v.resource_type)||(null===(b=e.dataset_schema)||void 0===b?void 0:b["@type"])||e.resource_type,G=(null===(j=e.dataset_schema)||void 0===j?void 0:null===(y=j.keywords)||void 0===y?void 0:y.filter(e=>"string"==typeof e&&!e.includes("<a title=")&&!e.startsWith("<")))||[],J=e.instruments||(null!==(N=null===(C=e.extra_data)||void 0===C?void 0:C.instruments)&&void 0!==N?N:[]),q=null===(w=e.dataset_schema)||void 0===w?void 0:null===(A=w.includedInDataCatalog)||void 0===A?void 0:A.map(e=>({name:e.name||"Data Catalog",url:e.url,logo:e.image})),X=e.variables_which_matched||[],Q=(null===(S=e.dataset_schema)||void 0===S?void 0:S.variableMeasured)||[],Y=[];(null===(k=e.dataset_schema)||void 0===k?void 0:k.url)&&Y.push(...e.dataset_schema.url),(null===(R=e.dataset_schema)||void 0===R?void 0:R.identifier)&&e.dataset_schema.identifier.forEach(e=>{e.startsWith("http://")||e.startsWith("https://")?Y.push(e):e.startsWith("10.")&&e.includes("/")&&Y.push("https://doi.org/".concat(e))}),Array.isArray(null===(_=e.extra_data)||void 0===_?void 0:_.dois)&&e.extra_data.dois.forEach(e=>{"string"==typeof e&&e.startsWith("http")&&Y.push("".concat(e))});let Z=e.child_datasets||[],$=(null===(I=e.extra_data)||void 0===I?void 0:I.ai_summary)||null;return{uuid:null===(E=e.extra_data)||void 0===E?void 0:E.uuid,title:H,description:O,image:F,publisher:W,funders:U,geographicCoverage:L,temporalCoverage:M,ageCoverage:V,studyDesign:P,resourceType:K,topics:G,instruments:J,dataCatalogs:q,matchedVariables:X,allVariables:Q,additionalLinks:Y,child_datasets:Z,aiSummary:$}}(t);e||(q(o),Z({originalSearchResult:_,lookupData:t}),Q(!1))}catch(t){console.error("Failed to load enhanced study detail:",t),e||Q(!1)}}(),()=>{e=!0}},[I,_]);let[ed,ec]=(0,p.useState)(!1),[eu,eh]=(0,p.useState)(!1),[eg,ep]=(0,p.useState)({description:!0,details:!1,variables:!1,links:!1,childDatasets:!1}),ex=e=>{ep(t=>({...t,[e]:!t[e]}))},em=(J.topics||[]).filter(e=>"string"==typeof e&&!e.includes("<a title=")&&!e.startsWith("<")),ef=em.length>0,ev=(J.instruments||[]).length>0,eb=(J.matchedVariables||[]).length>0||(J.allVariables||[]).length>0,ey=(J.additionalLinks||[]).length>0;console.log("StudyDetail instruments debug:",{instruments:J.instruments||[],hasInstruments:ev,instrumentsLength:(J.instruments||[]).length});let ej=(0,p.useMemo)(()=>{var e,t;console.log("study var deduping :",{matchedVariables:J.matchedVariables,allVariables:J.allVariables,matchedLength:null===(e=J.matchedVariables)||void 0===e?void 0:e.length,allLength:null===(t=J.allVariables)||void 0===t?void 0:t.length});let o=J.matchedVariables||[],a=J.allVariables||[],n=new Map;return o.forEach(e=>{let t=e.uuid||e.name;t&&n.set(t,{...e,matched:!0})}),a.forEach(e=>{let t=e.uuid||e.name;!t||n.has(t)||n.set(t,e)}),Array.from(n.values())},[J.matchedVariables,J.allVariables]);return(0,a.jsxs)(n.default,{sx:{p:3,width:"100%",height:"100%",overflowY:"auto",flex:1,display:"flex",flexDirection:"column",position:"relative"},children:[X&&(0,a.jsxs)(n.default,{sx:{position:"absolute",top:8,right:8,zIndex:10,display:"flex",alignItems:"center",gap:.5,p:.5,bgcolor:"background.paper",borderRadius:1,boxShadow:1,border:"1px solid",borderColor:"divider"},children:[(0,a.jsx)(i.A,{size:12}),(0,a.jsx)(l.A,{variant:"caption",color:"text.secondary",sx:{fontSize:{xs:"0.6rem",sm:"0.7rem"}},children:"Loading..."})]}),w&&(0,a.jsx)(n.default,{sx:{display:"flex",justifyContent:"flex-end",mb:2},children:(0,a.jsx)(s.A,{size:"small",onClick:()=>ec(!0),sx:{opacity:.6,"&:hover":{opacity:1},color:"text.secondary"},children:(0,a.jsx)(c.A,{size:18})})}),w&&ee&&(0,a.jsx)(n.default,{sx:{display:"flex",justifyContent:"flex-end",mb:2},children:(0,a.jsx)(s.A,{onClick:er,disabled:T,sx:{color:M?"primary.main":"text.secondary","&:hover":{color:M?"primary.dark":"primary.main"}},title:M?"Remove from saved":"Save to my resources",children:T?(0,a.jsx)(i.A,{size:20}):(0,a.jsx)(u.A,{size:20,fill:M?"currentColor":"none"})})}),!w&&(0,a.jsxs)(n.default,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:2,mb:4},children:[(0,a.jsx)(n.default,{sx:{flex:1},children:(0,a.jsxs)(n.default,{sx:{display:"flex",alignItems:"flex-start",justifyContent:"space-between"},children:[(0,a.jsx)(l.A,{variant:"h4",gutterBottom:!0,sx:{flex:1,mr:1},children:J.title}),ee&&(0,a.jsx)(s.A,{onClick:er,disabled:T,sx:{color:M?"primary.main":"text.secondary","&:hover":{color:M?"primary.dark":"primary.main"}},title:M?"Remove from saved":"Save to my resources",children:T?(0,a.jsx)(i.A,{size:20}):(0,a.jsx)(u.A,{size:20,fill:M?"currentColor":"none"})}),(0,a.jsx)(s.A,{size:"small",onClick:()=>ec(!0),sx:{opacity:.6,"&:hover":{opacity:1},color:"text.secondary",mt:.5},children:(0,a.jsx)(c.A,{size:18})})]})}),J.image&&!F&&(0,a.jsx)(n.default,{sx:{width:100,height:100,position:"relative",borderRadius:"8px",overflow:"hidden",flexShrink:0},children:(0,a.jsx)(d.default,{src:J.image,alt:J.title,fill:!0,style:{objectFit:"contain"},onError:()=>W(!0),unoptimized:!0},J.title)})]}),eo&&(0,a.jsxs)(n.default,{sx:{mb:4},children:[et&&(0,a.jsxs)(n.default,{sx:{display:"flex",alignItems:"center",gap:1,mb:2,p:1,bgcolor:"rgba(0, 0, 0, 0.02)",borderRadius:1},children:[(0,a.jsx)(l.A,{variant:"body2",sx:{fontWeight:500},children:"Description:"}),(0,a.jsxs)(n.default,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,a.jsx)(l.A,{variant:"body2",sx:{color:U?"text.secondary":"primary.main",fontWeight:U?400:600,cursor:"pointer"},onClick:()=>L(!1),children:"Original"}),(0,a.jsx)(l.A,{variant:"body2",sx:{color:"text.secondary"},children:"|"}),(0,a.jsx)(l.A,{variant:"body2",sx:{color:U?"primary.main":"text.secondary",fontWeight:U?600:400,cursor:"pointer"},onClick:()=>L(!0),children:"AI Summary"})]})]}),H?(0,a.jsx)(y.A,{text:eo,paragraphProps:{variant:"body1",sx:{mb:2}},compact:!0}):(0,a.jsx)(l.A,{variant:"body1",sx:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:5,WebkitBoxOrient:"vertical",mb:2},children:eo}),eo.length>300&&(0,a.jsxs)(n.default,{onClick:()=>O(!H),sx:{display:"flex",alignItems:"center",color:"primary.main",cursor:"pointer",mt:1},children:[(0,a.jsx)(l.A,{variant:"body2",color:"primary",sx:{fontWeight:500,mr:1},children:H?"Show Less":"Show More"}),H?(0,a.jsx)(h.A,{size:16}):(0,a.jsx)(g.A,{size:16})]})]}),eb&&(0,a.jsxs)(n.default,{sx:{mb:4},children:[(0,a.jsx)(x.A,{fullWidth:!0,chipVariant:"secondary",endIcon:E?(0,a.jsx)(h.A,{size:16,style:{fill:"#004735",stroke:"none"}}):(0,a.jsx)(g.A,{size:16,style:{fill:"#004735",stroke:"none"}}),sx:{justifyContent:"space-between",py:2,height:"auto"},onClick:()=>D(!E),children:(null===(t=J.matchedVariables)||void 0===t?void 0:t.length)===0?"Variables (".concat((null===(o=J.allVariables)||void 0===o?void 0:o.length)||0,")"):"Related Variables (".concat((null===(m=J.matchedVariables)||void 0===m?void 0:m.length)||0," / ").concat((null===(f=J.allVariables)||void 0===f?void 0:f.length)||0,")")}),(0,a.jsx)(r.A,{in:E,children:(0,a.jsx)(n.default,{sx:{p:2,bgcolor:"rgba(0, 0, 0, 0.02)",borderRadius:2,mb:2},children:(0,a.jsx)(V,{variables:ej,studyName:J.title})})})]}),(0,a.jsxs)(n.default,{sx:{mb:4},children:[(0,a.jsx)(x.A,{fullWidth:!0,chipVariant:"secondary",endIcon:eg.details?(0,a.jsx)(h.A,{size:16,style:{fill:"#004735",stroke:"none"}}):(0,a.jsx)(g.A,{size:16,style:{fill:"#004735",stroke:"none"}}),sx:{justifyContent:"space-between",py:2,height:"auto"},onClick:()=>ex("details"),children:"Details"}),(0,a.jsx)(r.A,{in:eg.details,children:(0,a.jsx)(n.default,{sx:{p:2,bgcolor:"rgba(0, 0, 0, 0.02)",borderRadius:2,mb:2},children:(0,a.jsxs)(n.default,{sx:{display:"flex",flexDirection:"column",gap:3},children:[J.publisher&&(0,a.jsxs)(n.default,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,a.jsx)(l.A,{variant:"subtitle2",children:"Publisher:"}),(0,a.jsx)(b.A,{name:J.publisher.name,url:J.publisher.url,logo:J.publisher.logo})]}),J.geographicCoverage&&(0,a.jsxs)(n.default,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,a.jsx)(l.A,{variant:"subtitle2",children:"Geographic Coverage:"}),(0,a.jsx)(l.A,{children:J.geographicCoverage})]}),J.temporalCoverage&&(0,a.jsxs)(n.default,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,a.jsx)(l.A,{variant:"subtitle2",children:"Temporal Coverage:"}),(0,a.jsx)(l.A,{children:(e=>{if(!e)return"Not specified";if(e.includes("..")){let[t,o]=e.split("..");return o?"".concat(t," - ").concat(o):"".concat(t," - Present (Ongoing)")}return e})(J.temporalCoverage)})]}),J.sampleSize&&"Not specified"!==J.sampleSize&&(0,a.jsxs)(n.default,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,a.jsx)(l.A,{variant:"subtitle2",children:"Sample Size:"}),(0,a.jsx)(l.A,{children:J.sampleSize})]}),J.ageCoverage&&(0,a.jsxs)(n.default,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,a.jsx)(l.A,{variant:"subtitle2",children:"Age Coverage:"}),(0,a.jsx)(l.A,{children:J.ageCoverage})]}),J.resourceType&&(0,a.jsxs)(n.default,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,a.jsx)(l.A,{variant:"subtitle2",children:"Resource Type:"}),(0,a.jsx)(l.A,{children:J.resourceType})]}),J.studyDesign&&J.studyDesign.length>0&&(0,a.jsxs)(n.default,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,a.jsx)(l.A,{variant:"subtitle2",children:"Study Design:"}),(0,a.jsx)(l.A,{children:J.studyDesign.join(", ")})]})]})})})]}),(J.funders||[]).length>0&&(0,a.jsxs)(n.default,{sx:{mb:4,flexShrink:0},children:[(0,a.jsx)(l.A,{variant:"subtitle2",gutterBottom:!0,children:"Funders:"}),(0,a.jsx)(n.default,{sx:{display:"flex",overflowX:"auto",gap:2,pb:1,"&::-webkit-scrollbar":{height:6},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(0,0,0,0.2)",borderRadius:3}},children:(J.funders||[]).map((e,t)=>(0,a.jsx)(b.A,{name:e.name,url:e.url,logo:e.logo},"".concat(e.name,"-").concat(t)))})]}),(J.dataCatalogs||[]).length>0&&(0,a.jsxs)(n.default,{sx:{mb:4,flexShrink:0},children:[(0,a.jsx)(l.A,{variant:"subtitle2",gutterBottom:!0,children:"Available in Data Catalogs:"}),(0,a.jsx)(n.default,{sx:{display:"flex",overflowX:"auto",gap:2,pb:1,"&::-webkit-scrollbar":{height:6},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(0,0,0,0.2)",borderRadius:3}},children:(J.dataCatalogs||[]).map((e,t)=>(0,a.jsx)(v,{name:e.name,url:e.url,logo:e.logo},"".concat(e.name,"-").concat(t)))})]}),ef&&(0,a.jsxs)(n.default,{sx:{mb:4},children:[(0,a.jsx)(l.A,{variant:"subtitle2",gutterBottom:!0,children:"Topics:"}),(0,a.jsx)(n.default,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:em.map((e,t)=>(0,a.jsx)(x.A,{onClick:t=>{t.stopPropagation(),S&&S(e)},sx:{cursor:"pointer"},children:e},"topic-".concat(t)))})]}),ey&&(0,a.jsxs)(n.default,{sx:{mb:4,flexShrink:0},children:[(0,a.jsx)(x.A,{fullWidth:!0,chipVariant:"secondary",endIcon:z?(0,a.jsx)(h.A,{size:16,style:{fill:"#004735",stroke:"none"}}):(0,a.jsx)(g.A,{size:16,style:{fill:"#004735",stroke:"none"}}),sx:{justifyContent:"space-between",py:2,height:"auto",mb:2},onClick:()=>N(!z),children:"Related Links & Papers"}),(0,a.jsx)(r.A,{in:z,children:z&&(0,a.jsx)(n.default,{sx:{display:"flex",flexWrap:"wrap",gap:2,mb:2,alignItems:"flex-start"},children:null===(C=J.additionalLinks)||void 0===C?void 0:C.map((e,t)=>(0,a.jsx)(n.default,{sx:{flex:"1 1 350px",minWidth:300,maxWidth:500},children:(0,a.jsx)(j.A,{url:e})},"link-".concat(t)))})})]}),ev&&(0,a.jsxs)(n.default,{sx:{mb:2},children:[(0,a.jsxs)(x.A,{fullWidth:!0,chipVariant:"secondary",endIcon:eu?(0,a.jsx)(h.A,{size:16,style:{fill:"#004735",stroke:"none"}}):(0,a.jsx)(g.A,{size:16,style:{fill:"#004735",stroke:"none"}}),sx:{justifyContent:"space-between",py:2,height:"auto",mb:2},onClick:()=>eh(e=>!e),children:["Instruments (",(J.instruments||[]).length,")"]}),(0,a.jsx)(r.A,{in:eu,children:(0,a.jsx)(n.default,{sx:{display:"flex",flexWrap:"wrap",gap:1,mt:1},children:(J.instruments||[]).map((e,t)=>(0,a.jsx)(x.A,{onClick:t=>{t.stopPropagation(),k&&k(e)},children:e},"instrument-".concat(t)))})})]}),Array.isArray(J.child_datasets)&&(J.child_datasets||[]).length>0&&(0,a.jsxs)(n.default,{sx:{mb:4},children:[(0,a.jsxs)(x.A,{fullWidth:!0,chipVariant:"secondary",endIcon:eg.childDatasets?(0,a.jsx)(h.A,{size:16,style:{fill:"#004735",stroke:"none"}}):(0,a.jsx)(g.A,{size:16,style:{fill:"#004735",stroke:"none"}}),sx:{justifyContent:"space-between",py:2,height:"auto"},onClick:()=>ex("childDatasets"),children:["Related Datasets (",(J.child_datasets||[]).length,")"]}),(0,a.jsx)(r.A,{in:eg.childDatasets,children:(0,a.jsx)(n.default,{sx:{p:2,bgcolor:"rgba(0, 0, 0, 0.02)",borderRadius:2,mb:2},children:(0,a.jsx)(ea,{datasets:J.child_datasets})})})]}),(0,a.jsx)($,{open:ed,onClose:()=>ec(!1),title:J.title,originalSearchResult:null==Y?void 0:Y.originalSearchResult,lookupData:null==Y?void 0:Y.lookupData,finalProcessedData:J})]})})},10683:(e,t,o)=>{"use strict";o.d(t,{AuthProvider:()=>h,A:()=>u});var a=o(95155),n=o(12115),i=o(14565),l=o(49904),s=o(27058);let r=(0,l.Wp)({apiKey:"AIzaSyBQVkRjbTQD6BXCdo2JeiFfwyvGVT7bOXM",authDomain:"harmony-6bd51.firebaseapp.com",projectId:"harmony-6bd51",storageBucket:"harmony-6bd51.appspot.com",messagingSenderId:"914732561143",appId:"1:914732561143:web:b041f0c5e7fab57400d9f2",measurementId:"G-S79J6E39ZP"}),d=(0,i.xI)(r);(0,s.aU)(r);let c=(0,n.createContext)(void 0);function u(){let e=(0,n.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function h(e){let{children:t}=e,[o,l]=(0,n.useState)(null),[s,r]=(0,n.useState)(!0),u=async e=>(0,i.df)(d,e).then(e=>e.user).catch(t=>e.credentialFromError(t));return(0,n.useEffect)(()=>(0,i.hg)(d,e=>{l(e),r(!1)}),[]),(0,a.jsx)(c.Provider,{value:{currentUser:o,login:function(e,t){return(0,i.x9)(d,e,t)},signup:function(e,t){return(0,i.eJ)(d,e,t)},logout:function(){return(0,i.CI)(d)},resetPassword:function(e){return(0,i.J1)(d,e)},signInWithGoogle:function(){return u(new i.HF)},signInWithGitHub:function(){return u(new i.Dt)},signInWithTwitter:function(){return u(new i.ny)},loading:s},children:!s&&t})}},73179:(e,t,o)=>{"use strict";o.d(t,{db:()=>s});var a=o(49904),n=o(14565),i=o(54615);let l=(0,a.Wp)({apiKey:"AIzaSyBQVkRjbTQD6BXCdo2JeiFfwyvGVT7bOXM",authDomain:"harmony-6bd51.firebaseapp.com",projectId:"harmony-6bd51",storageBucket:"harmony-6bd51.appspot.com",messagingSenderId:"914732561143",appId:"1:914732561143:web:b041f0c5e7fab57400d9f2",measurementId:"G-S79J6E39ZP"});(0,n.xI)(l);let s=(0,i.aU)(l)},3485:(e,t,o)=>{"use strict";o.d(t,{sM:()=>l,xC:()=>s});var a=o(2818);let n={"Office for National Statistics":"ONS","National Health Service":"NHS","Department for Education":"DfE","Department of Health":"DoH","Department of Health and Social Care":"DHSC","Medical Research Council":"MRC","National Institute for Health and Care Excellence":"NICE","National Institute for Health Research":"NIHR","Economic and Social Research Council":"ESRC","Arts and Humanities Research Council":"AHRC","Biotechnology and Biological Sciences Research Council":"BBSRC","Engineering and Physical Sciences Research Council":"EPSRC","Natural Environment Research Council":"NERC","Science and Technology Facilities Council":"STFC","UK Research and Innovation":"UKRI","University College London":"UCL","University of Oxford":"Oxford","University of Cambridge":"Cambridge","Imperial College London":"Imperial","King's College London":"KCL","London School of Economics":"LSE","Edinburgh University":"Edin","University of Manchester":"Manchester","University of Bristol":"Bristol","University of Warwick":"Warwick","World Health Organization":"WHO","United Nations":"UN","European Union":"EU_flag","Organisation for Economic Co-operation and Development":"OECD","Wellcome Trust":"Wellcome","Nuffield Foundation":"Nuffield","British Heart Foundation":"BHF","Cancer Research UK":"CRUK","Alzheimer's Society":"Alzheimer","Diabetes UK":"Diabetes","National Institute of Mental Health":"NIMH","National Institutes of Health":"NIH","Centers for Disease Control and Prevention":"CDC","Social Care Institute for Excellence":"SCIE"},i={MRC:"/logos/MRC.png",ESRC:"/logos/ESRC.png",UKRI:"/logos/UKRI.png",NERC:"/logos/NERC.png",STFC:"/logos/STFC.png",AHRC:"/logos/AHRC.png",BBSRC:"/logos/BBSRC.png",EPSRC:"/logos/EPSRC.png",NIHR:"/logos/NIHR.png",BHF:"/logos/BHF.png",CRUK:"/logos/CRUK.png",Wellcome:"/logos/Wellcome.png",Nuffield:"/logos/Nuffield.png",ONS:"/logos/ONS.png",NHS:"/logos/NHS.png",DfE:"/logos/DfE.png",DHSC:"/logos/DHSC.png",DoHSC:"/logos/DHSC.png",NICE:"/logos/NICE.png",SCIE:"/logos/SCIE.png",HOUK:"/logos/HOUK.png",UCL:"/logos/UCL.png",Oxford:"/logos/Oxford.png",Cambridge:"/logos/Cambridge.png",Imperial:"/logos/Imperial.png",KCL:"/logos/KCL.png",LSE:"/logos/LSE.png",Edin:"/logos/Edin.png",NIH:"/logos/NIH.png",NIMH:"/logos/NIMH.png",NIDA:"/logos/NIDA.png",NIAAA:"/logos/NIAAA.png",NSF:"/logos/NSF.png",CDC:"/logos/CDC.png",FDA:"/logos/FDA.png",EU_flag:"/logos/EU_flag.png",EUCom:"/logos/EUCom.png",ERC:"/logos/ERC.png",H2020:"/logos/H2020.png",HorizonEU:"/logos/HorizonEU.png",WHO:"/logos/WHO.png",VR:"/logos/VR.png",BMBF:"/logos/BMBF.png",DFG:"/logos/DFG.png",CNRS:"/logos/CNRS.png",INSERM:"/logos/INSERM.png",ARC:"/logos/ARC.png",NHMRC:"/logos/NHMRC.png",CIHR:"/logos/CIHR.png",Uni:"/logos/university.png",Hosp:"/logos/hospital.png",Gov:"/logos/government.png",NGO:"/logos/ngo.png",Charity:"/logos/charity.png",Rayne:"/logos/Rayne.png",SRFound:"/logos/SRFound.png",BCTrust:"/logos/BCTrust.png",UKHF:"/logos/UKHF.png",RCN:"/logos/RCN.png",KingsFund:"/logos/KingsFund.png",MHRN:"/logos/MHRN.png",McPF:"/logos/McPF.png",BLF:"/logos/BLF.png",CLAHRC:"/logos/CLAHRC.png",TNA:"/logos/TNA.png",NAO:"/logos/NAO.png",RCP:"/logos/RCP.png",SU:"/logos/SU.png",SLaM:"/logos/SLaM.png"};function l(e,t){if(t&&t.trim().length>0)return console.log("Using provided logo for ".concat(e||"Unknown",": ").concat(t)),t;if(!e||0===e.trim().length){console.log("No organization name provided to findOrganizationLogo");return}if(e.includes(" ")&&e.split(" ").every(e=>e.length<=6)){for(let t of(console.log('Organization name "'.concat(e,'" appears to be a space-delimited list of abbreviations')),e.split(" ").map(e=>e.trim()).filter(e=>e.length>0))){if(i[t])return console.log('Found direct logo match for abbreviation "'.concat(t,'": ').concat(i[t])),i[t];for(let[e,o]of Object.entries(n))if(e.toLowerCase().includes(t.toLowerCase())||o.toLowerCase()===t.toLowerCase()){let a="/logos/".concat(o,".png");return console.log('Found partial match for "'.concat(t,'" with known organization "').concat(e,'" (').concat(o,"): ").concat(a)),a}}console.log('No logo match found for any part of "'.concat(e,'"'));return}let o=n[e];if(o){let t="/logos/".concat(o,".png");return console.log('Found direct organization match for "'.concat(e,'": ').concat(t)),t}if(i[e])return console.log('Found direct logo match for organization abbreviation "'.concat(e,'": ').concat(i[e])),i[e];for(let[t,o]of Object.entries(n))if(e.toLowerCase().includes(t.toLowerCase())||e.toLowerCase().includes(o.toLowerCase())){let a="/logos/".concat(o,".png");return console.log('Found partial match for "'.concat(e,'" with known organization "').concat(t,'": ').concat(a)),a}console.log('No logo match found for "'.concat(e,'"'))}function s(){return a.env.GITHUB_PAGES_DEPLOYMENT?"/search/":window.location.pathname.startsWith("/search")?"/search/":"/"}},67699:()=>{}}]);