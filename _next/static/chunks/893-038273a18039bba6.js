(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[893],{83686:()=>{},32383:()=>{},86453:(e,t,o)=>{"use strict";o.d(t,{A:()=>g});var n=o(95155),l=o(78416),a=o(36417),i=o(9561),s=o(68998),r=o(47821),d=o(27753),c=o(26214),u=o(22282),h=o(2743),x=o(6327),p=o(2599);function g(e){let{open:t,onClose:o,data:g,title:f="Debug Data"}=e,m=()=>{navigator.clipboard.writeText(JSON.stringify(g,null,2))};return(0,n.jsxs)(l.A,{open:t,onClose:o,maxWidth:"lg",fullWidth:!0,sx:{"& .MuiDialog-paper":{maxHeight:"90vh",height:"90vh"}},children:[(0,n.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:1},children:[(0,n.jsx)(i.default,{variant:"h6",component:"div",children:f}),(0,n.jsxs)(s.default,{children:[(0,n.jsx)(r.A,{onClick:m,size:"small",sx:{mr:1},title:"Copy JSON to clipboard",children:(0,n.jsx)(h.A,{fontSize:"small"})}),(0,n.jsx)(r.A,{onClick:o,size:"small",children:(0,n.jsx)(x.A,{fontSize:"small"})})]})]}),(0,n.jsx)(d.A,{dividers:!0,sx:{p:0,height:"100%"},children:t&&(0,n.jsx)(s.default,{sx:{height:"100%",overflow:"auto","& .w-json-view-container":{backgroundColor:"#fafafa",fontSize:"13px",fontFamily:'"SF Mono", Monaco, "Cascadia Code", "Roboto Mono", Consolas, "Courier New", monospace'}},children:(0,n.jsx)(p.Ay,{value:g,collapsed:2,displayObjectSize:!0,displayDataTypes:!0,enableClipboard:!0,style:{backgroundColor:"#fafafa",padding:"16px"}})})}),(0,n.jsxs)(c.A,{children:[(0,n.jsx)(u.A,{onClick:m,startIcon:(0,n.jsx)(h.A,{}),children:"Copy JSON"}),(0,n.jsx)(u.A,{onClick:o,variant:"contained",children:"Close"})]})]})}},65776:(e,t,o)=>{"use strict";o.d(t,{A:()=>c});var n=o(95155),l=o(64665),a=o(68998),i=o(9561),s=o(5565),r=o(3485),d=o(12115);function c(e){let{name:t,url:o,logo:c,inactive:u,compact:h}=e,[x,p]=(0,d.useState)(c),[g,f]=(0,d.useState)(!1);(0,d.useEffect)(()=>{console.log('Resolving logo for organization: "'.concat(t,'"'));try{let e=(0,r.sM)(t,c);console.log('Resolved logo for organization "'.concat(t,'":'),e),p(e),f(!1)}catch(e){console.error('Error resolving logo for organization "'.concat(t,'":'),e),p(void 0)}},[t,c]);let m=x&&x.length>0&&!g;return(0,n.jsxs)(l.A,{elevation:0,sx:{display:"flex",borderRadius:"16px",overflow:"hidden",width:h?"220px":"280px",height:h?"75px":"85px",flexShrink:0,border:"1px solid",borderColor:"grey.200",cursor:o?"pointer":"default",transition:"all 0.2s",opacity:u?.5:1,"&:hover":o?{boxShadow:2,borderColor:"primary.main"}:{}},onClick:()=>{o&&window.open(o,"_blank","noopener,noreferrer")},children:[(0,n.jsx)(a.default,{sx:{flex:1,bgcolor:"rgba(0,0,0,0.03)",p:2,display:"flex",flexDirection:"column",justifyContent:"center"},children:(0,n.jsx)(i.default,{sx:{fontWeight:500,fontSize:h?"0.8rem":"0.9rem",lineHeight:1.2,overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",maxHeight:"3.9em",wordBreak:"break-word",paddingBottom:"1px"},children:t})}),m&&(0,n.jsx)(a.default,{sx:{width:"30%",bgcolor:"white",display:"flex",alignItems:"center",justifyContent:"center",p:1,borderLeft:"1px solid",borderColor:"grey.200"},children:(0,n.jsx)(s.default,{src:x,alt:t,width:h?40:50,height:h?40:50,style:{objectFit:"contain"},onError:()=>{console.error('Error loading image for organization "'.concat(t,'" from path: ').concat(x)),f(!0)},unoptimized:!0})})]})}},53452:(e,t,o)=>{"use strict";o.d(t,{A:()=>l});var n=o(22282);let l=(0,o(89142).Ay)(n.A,{shouldForwardProp:e=>"chipVariant"!==e})(e=>{let{theme:t,chipVariant:o="primary",onClick:n=()=>{}}=e;return{onClick:n,borderRadius:8,textTransform:"none",padding:"0 16px",height:32,minHeight:32,fontSize:"0.875rem",fontWeight:500,whiteSpace:"nowrap",lineHeight:1,..."primary"===o&&{backgroundColor:t.palette.primary.main,color:t.palette.primary.contrastText,"&:hover":{backgroundColor:t.palette.primary.dark}},..."secondary"===o&&{backgroundColor:t.palette.secondary.main,color:t.palette.secondary.contrastText,"&:hover":{backgroundColor:t.palette.secondary.dark}},..."dark"===o&&{backgroundColor:"#444653",color:"#FFFFFF","&:hover":{backgroundColor:"#363742"}}}})},49754:(e,t,o)=>{"use strict";o.d(t,{A:()=>eo});var n=o(95155),l=o(68998),a=o(47821),i=o(9561),s=o(35256),r=o(5565),d=o(90675),c=o(52488),u=o(32645),h=o(12115),x=o(53452),p=o(64665),g=o(3485);function f(e){let{name:t,url:o,logo:a}=e,[s,d]=(0,h.useState)(a),[c,u]=(0,h.useState)(!1);(0,h.useEffect)(()=>{console.log('Resolving logo for data catalog: "'.concat(t,'"'));try{let e=(0,g.sM)(t,a);console.log('Resolved logo for data catalog "'.concat(t,'":'),e),d(e),u(!1)}catch(e){console.error('Error resolving logo for data catalog "'.concat(t,'":'),e),d(void 0)}},[t,a]);let x=s&&s.length>0&&!c;return(0,n.jsxs)(p.A,{elevation:0,sx:{display:"flex",borderRadius:"16px",overflow:"hidden",width:"280px",height:"80px",flexShrink:0,border:"1px solid",borderColor:"grey.200",cursor:o?"pointer":"default",transition:"all 0.2s","&:hover":o?{boxShadow:2,borderColor:"primary.main"}:{}},onClick:()=>{o&&window.open(o,"_blank","noopener,noreferrer")},children:[(0,n.jsx)(l.default,{sx:{flex:1,bgcolor:"rgba(0,0,0,0.03)",p:2,display:"flex",flexDirection:"column",justifyContent:"center"},children:(0,n.jsx)(i.default,{sx:{fontWeight:500,fontSize:"0.9rem",lineHeight:1.2,overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",maxHeight:"3.7em",wordBreak:"break-word"},children:t})}),x&&(0,n.jsx)(l.default,{sx:{width:"30%",bgcolor:"white",display:"flex",alignItems:"center",justifyContent:"center",p:1,borderLeft:"1px solid",borderColor:"grey.200"},children:(0,n.jsx)(r.default,{src:s,alt:t,width:50,height:50,style:{objectFit:"contain"},onError:()=>{console.error('Error loading image for data catalog "'.concat(t,'" from path: ').concat(s)),u(!0)},unoptimized:!0})})]})}var m=o(65776),j=o(51857),b=o(67247),y=o(26536),C=o(30997),v=o(57165),A=o(53326),w=o(72926),S=o(66917),R=o(4918),k=o(41983),z=o(2091),E=o(60391),I=o(78416),N=o(36417),D=o(27753),H=o(10319),L=o(10358),O=o(64364),U=o(71569),F=o(689),W=o(48694),M=o(7660);function _(e){let{variables:t,studyName:o,downloadAnchorEl:i,onDownloadClick:s,onDownloadClose:r}=e,d=(0,h.useRef)(null),c=(0,h.useRef)(null),[u,x]=(0,h.useState)(!1),[p,g]=(0,h.useState)(!1);console.log("variables passed:",t),(0,h.useEffect)(()=>{if(customElements.get("harmony-export"))return;let e=document.createElement("script");return e.src="/app/js/harmony-export.js",e.async=!0,document.body.appendChild(e),()=>{document.body.contains(e)&&document.body.removeChild(e)}},[]);let f=[{field:"description",headerName:"Description / Code",flex:2,valueGetter:(e,t)=>(t.score?"[MATCHING] ":"")+(t.description||t.name)+(t.description&&t.name?" ("+t.name+")":""),sortable:!1},{field:"options",headerName:"Response Options",flex:1,valueGetter:(e,t)=>t.options&&Array.isArray(t.options)?t.options.join(" / "):"",sortable:!1}],m=t.filter(e=>e.name||e.description).map((e,t)=>({id:e.uuid||e.name||t,...e})),j=(0,y.b)();(0,h.useEffect)(()=>{let e=setTimeout(()=>{j.current&&x(!0)},200);return()=>clearTimeout(e)},[j]);let b=()=>{let e=j.current;if(e&&u)try{let t=e.getSelectedRows(),o=t&&"number"==typeof t.size&&t.size>0;g(o)}catch(e){g(!1)}},I=()=>{let e=j.current;if(!e||!u)return 0;try{let t=e.getSelectedRows();return t&&"number"==typeof t.size?t.size:0}catch(e){return 0}};(0,h.useEffect)(()=>{if(!u)return;let e=setInterval(()=>{b()},500);return()=>{clearInterval(e)}},[u]);let N=()=>{null==r||r()},D=()=>{let e;let t=j.current;if(!t||!u)return[];try{e=t.getSelectedRows()}catch(t){e=null}return(e&&"number"==typeof e.size&&e.size>0&&e?Array.from(e.values()):(()=>{let e;try{e=t.getRowModels()}catch(t){e=null}return e?Array.from(e.values()):[]})()).map((e,t)=>({question_no:e.description?e.name:t,question_text:e.description||e.name,response_options:e.options&&Array.isArray(e.options)?e.options.join(" / "):""}))},F=()=>{let e;let t=j.current;if(!t||!d.current||!u)return;try{e=t.getSelectedRows()}catch(t){e=null}if(!e||"number"!=typeof e.size)return;console.log("selectedIds:",e);let n=Array.from(e.values()).map((e,t)=>({question_no:e.description?e.name:t,question_text:e.description||e.name})),l=document.createElement("harmony-export");l.size="32px",l.instrument_name="".concat(o||"Selected Variables"," from harmonydata.ac.uk/discover"),l.questions=n,d.current.innerHTML="",d.current.appendChild(l)};return(0,h.useEffect)(()=>{if(!u)return;let e=setTimeout(()=>{F()},100);return()=>clearTimeout(e)},[u,p]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.default,{sx:{height:"100%",minHeight:400},children:m.length>0&&(0,n.jsx)(C.z,{autoPageSize:!0,apiRef:j,rows:m,columns:f,checkboxSelection:!0,disableRowSelectionOnClick:!0,sortModel:[{field:"score",sort:"desc"}],sx:{background:"white",borderRadius:2,fontSize:14,height:"100%"},hideFooterSelectedRowCount:!0,pageSizeOptions:[10,25,50],showToolbar:!0,slots:{toolbar:()=>(0,n.jsxs)(l.default,{sx:{display:"flex",alignItems:"center",gap:2,p:1,mr:2},children:[(0,n.jsx)(v.e,{expanded:!0,style:{width:"100%"},children:(0,n.jsx)(A.X,{placeholder:"Search within variables",style:{background:"white",borderRadius:192,fontSize:14,margin:15,width:"calc(100% - 15px)",height:"auto"}})}),p&&(0,n.jsx)(w.A,{title:"Harmonise selected items",children:(0,n.jsx)(a.A,{size:"small",sx:{width:40,height:40},children:(0,n.jsx)(l.default,{ref:d,sx:{display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20}})})}),(0,n.jsx)(w.A,{title:p?"Download ".concat(I()," selected questions"):"Download all questions",children:(0,n.jsx)(a.A,{ref:c,size:"small",onClick:s,sx:{width:40,height:40},children:(0,n.jsx)(H.A,{size:30})})})]})}})}),(0,n.jsx)(S.Ay,{open:!!i,anchorEl:i,onClose:N,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"center"},children:(0,n.jsxs)(R.A,{sx:{width:200},children:[(0,n.jsxs)(k.Ay,{onClick:()=>{let e=new Blob([JSON.stringify(D(),null,2)],{type:"application/json"}),t=URL.createObjectURL(e),o=document.createElement("a");o.href=t,o.download="questions.json",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(t),N()},sx:{cursor:"pointer"},children:[(0,n.jsx)(z.A,{children:(0,n.jsx)(L.A,{size:20})}),(0,n.jsx)(E.A,{primary:"Download as JSON"})]}),(0,n.jsxs)(k.Ay,{onClick:()=>{let e=new Blob([[["Question Number","Question Text","Response Options"],...D().map(e=>[e.question_no,e.question_text,e.response_options])].map(e=>e.map(e=>'"'.concat(e,'"')).join(",")).join("\n")],{type:"text/csv"}),t=URL.createObjectURL(e),o=document.createElement("a");o.href=t,o.download="questions.csv",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(t),N()},sx:{cursor:"pointer"},children:[(0,n.jsx)(z.A,{children:(0,n.jsx)(O.A,{size:20})}),(0,n.jsx)(E.A,{primary:"Download as CSV"})]}),(0,n.jsxs)(k.Ay,{onClick:()=>{let e=D(),t=M.Wp.json_to_sheet(e),o=M.Wp.book_new();M.Wp.book_append_sheet(o,t,"Questions");let n=new Blob([M.M9(o,{bookType:"xlsx",type:"array"})],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),l=URL.createObjectURL(n),a=document.createElement("a");a.href=l,a.download="questions.xlsx",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(l),N()},sx:{cursor:"pointer"},children:[(0,n.jsx)(z.A,{children:(0,n.jsx)(U.A,{size:20})}),(0,n.jsx)(E.A,{primary:"Download as Excel"})]})]})})]})}function B(e){let{variables:t,studyName:o}=e,[s,r]=(0,h.useState)(!1),d=(0,h.useRef)(null),[c,u]=(0,h.useState)(null),x=()=>{u(null),r(!1)},p=(0,n.jsx)(_,{variables:t,studyName:o,downloadAnchorEl:c,onDownloadClick:e=>{console.log("handleDownloadClick",e.currentTarget),u(d.current)},onDownloadClose:()=>{u(null)}});return s?(0,n.jsxs)(I.A,{ref:d,open:!0,onClose:x,maxWidth:"xl",fullWidth:!0,sx:{"& .MuiDialog-paper":{height:"90vh",maxHeight:"90vh"}},children:[(0,n.jsxs)(N.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:1},children:[(0,n.jsxs)(i.default,{variant:"h6",children:["Variables - ",o||"Study"]}),(0,n.jsx)(a.A,{onClick:x,size:"small",sx:{color:"text.secondary"},children:(0,n.jsx)(F.A,{size:20})})]}),(0,n.jsx)(D.A,{sx:{p:0,overflow:"hidden"},children:(0,n.jsx)(l.default,{sx:{height:"100%","& .MuiDataGrid-root":{borderRadius:0,maxHeight:"none",height:"100%"}},children:p})})]}):(0,n.jsxs)(l.default,{ref:d,sx:{position:"relative"},children:[(0,n.jsx)(l.default,{sx:{position:"absolute",top:8,right:8,zIndex:10,backgroundColor:"rgba(255, 255, 255, 0.9)",borderRadius:1},children:(0,n.jsx)(w.A,{title:"Open in large view",children:(0,n.jsx)(a.A,{size:"small",onClick:()=>{u(null),r(!0)},children:(0,n.jsx)(W.A,{size:20})})})}),(0,n.jsx)(l.default,{sx:{"& .MuiDataGrid-root":{height:450,borderRadius:2}},children:p})]})}o(67699);var T=o(22282),P=o(90662),V=o(28222),K=o(65330),q=o(26214),G=o(2743),J=o(6327),Q=o(51644),X=o(86453);function Y(e){let{open:t,onClose:o,title:s,originalSearchResult:r,lookupData:d,finalProcessedData:c}=e,[u,x]=(0,h.useState)(!1),[p,g]=(0,h.useState)(null),[f,m]=(0,h.useState)(""),j=()=>{navigator.clipboard.writeText(JSON.stringify({originalSearchResult:r,lookupData:d,finalProcessedData:c},null,2))},b=(e,t)=>{g(e),m(t),x(!0)},y=e=>{let{data:t,label:o}=e;return t?(0,n.jsxs)(l.default,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[(0,n.jsxs)(i.default,{variant:"body2",children:[(0,n.jsxs)("strong",{children:[o,":"]})," ",(e=>{var t,o;if(!e||"object"!=typeof e)return"Invalid data";let n=Object.keys(e).length,l=e.title||(null===(t=e.dataset_schema)||void 0===t?void 0:t.name)||(null===(o=e.extra_data)||void 0===o?void 0:o.name)||e.name||"Unnamed";return"".concat(l," (").concat(n," top-level properties)")})(t)]}),(0,n.jsx)(T.A,{size:"small",variant:"outlined",onClick:()=>b(t,"".concat(s," - ").concat(o)),sx:{ml:2},children:"View JSON"})]}):(0,n.jsxs)(i.default,{variant:"body2",color:"text.secondary",sx:{fontStyle:"italic"},children:["No ",o.toLowerCase()," data available"]})};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(I.A,{open:t,onClose:o,maxWidth:"md",fullWidth:!0,sx:{"& .MuiDialog-paper":{maxHeight:"80vh"}},children:[(0,n.jsxs)(N.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:1},children:[(0,n.jsxs)(i.default,{variant:"h6",component:"div",children:["Debug Data: ",s]}),(0,n.jsxs)(l.default,{children:[(0,n.jsx)(a.A,{onClick:j,size:"small",sx:{mr:1},title:"Copy all data to clipboard",children:(0,n.jsx)(G.A,{fontSize:"small"})}),(0,n.jsx)(a.A,{onClick:o,size:"small",children:(0,n.jsx)(J.A,{fontSize:"small"})})]})]}),(0,n.jsx)(D.A,{dividers:!0,sx:{p:3},children:t&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.default,{variant:"subtitle1",gutterBottom:!0,sx:{mb:3},children:"Data Pipeline Overview"}),(0,n.jsxs)(l.default,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,n.jsxs)(P.A,{defaultExpanded:!1,children:[(0,n.jsx)(V.A,{expandIcon:(0,n.jsx)(Q.A,{}),children:(0,n.jsx)(i.default,{variant:"subtitle2",sx:{fontWeight:600},children:"1. Original Search Result"})}),(0,n.jsxs)(K.A,{children:[(0,n.jsx)(i.default,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"The raw data returned from the search API when this result was found."}),(0,n.jsx)(y,{data:r,label:"Original Search Result"})]})]}),(0,n.jsxs)(P.A,{defaultExpanded:!1,children:[(0,n.jsx)(V.A,{expandIcon:(0,n.jsx)(Q.A,{}),children:(0,n.jsx)(i.default,{variant:"subtitle2",sx:{fontWeight:600},children:"2. Lookup Data"})}),(0,n.jsxs)(K.A,{children:[(0,n.jsx)(i.default,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"The full data fetched from the lookup API using the UUID from the search result."}),(0,n.jsx)(y,{data:d,label:"Lookup Data"})]})]}),(0,n.jsxs)(P.A,{defaultExpanded:!1,children:[(0,n.jsx)(V.A,{expandIcon:(0,n.jsx)(Q.A,{}),children:(0,n.jsx)(i.default,{variant:"subtitle2",sx:{fontWeight:600},children:"3. Final Processed Data"})}),(0,n.jsxs)(K.A,{children:[(0,n.jsx)(i.default,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"The processed and formatted data that is displayed in the StudyDetail component."}),(0,n.jsx)(y,{data:c,label:"Final Processed Data"})]})]})]}),(0,n.jsx)(l.default,{sx:{mt:3,p:2,bgcolor:"grey.50",borderRadius:1},children:(0,n.jsxs)(i.default,{variant:"caption",color:"text.secondary",children:[(0,n.jsx)("strong",{children:"Data Flow:"})," Original Search Result → Lookup API → Processing & Mapping → StudyDetail Component"]})})]})}),(0,n.jsxs)(q.A,{children:[(0,n.jsx)(T.A,{onClick:j,startIcon:(0,n.jsx)(G.A,{}),children:"Copy All Data"}),(0,n.jsx)(T.A,{onClick:o,variant:"contained",children:"Close"})]})]}),(0,n.jsx)(X.A,{open:u,onClose:()=>x(!1),data:p,title:f})]})}var Z=o(42479),$=o(66656),ee=o(49234);function et(e){var t,o,a,s,r,d,c,u,h,x;let{dataset:g}=e,f=(null===(t=g.dataset_schema)||void 0===t?void 0:t.name)||(null===(o=g.extra_data)||void 0===o?void 0:o.name)||"Untitled Dataset",m=(null===(a=g.dataset_schema)||void 0===a?void 0:a.description)||(null===(s=g.extra_data)||void 0===s?void 0:s.description)||"",j=(null===(d=g.dataset_schema)||void 0===d?void 0:null===(r=d.url)||void 0===r?void 0:r[0])||"#",b=(null===(c=g.dataset_schema)||void 0===c?void 0:c.keywords)||(null===(u=g.extra_data)||void 0===u?void 0:u.keywords)||[],y=null===(h=g.dataset_schema)||void 0===h?void 0:h.size,C=null===(x=g.dataset_schema)||void 0===x?void 0:x.temporalCoverage;return(0,n.jsx)(p.A,{elevation:1,sx:{minWidth:280,maxWidth:400,flex:"1 1 320px",display:"flex",flexDirection:"column",mb:2},children:(0,n.jsxs)(Z.A,{sx:{flex:1,display:"flex",flexDirection:"column"},children:[(0,n.jsx)($.A,{href:j,target:"_blank",rel:"noopener noreferrer",underline:"hover",sx:{fontWeight:600,fontSize:"1.1rem",mb:1,color:"primary.main"},children:f}),m&&(0,n.jsx)(i.default,{variant:"body2",color:"text.secondary",sx:{mb:1},children:m.length>120?m.slice(0,120)+"...":m}),b.length>0&&(0,n.jsx)(l.default,{sx:{display:"flex",flexWrap:"wrap",gap:.5,mb:1},children:b.slice(0,6).map((e,t)=>(0,n.jsx)(ee.A,{label:e,size:"small",variant:"outlined"},e+t))}),(0,n.jsxs)(l.default,{sx:{display:"flex",gap:2,mt:"auto"},children:[y&&(0,n.jsxs)(i.default,{variant:"caption",color:"text.secondary",children:["Size: ",y]}),C&&(0,n.jsxs)(i.default,{variant:"caption",color:"text.secondary",children:["Years: ",C]})]})]})})}let eo=(0,h.memo)(e=>{var t,o;let{study:p,isDrawerView:g=!1,onTopicClick:y,onInstrumentClick:C,debugData:v}=e,[A,w]=(0,h.useState)(!1),[S,R]=(0,h.useState)(!1),[k,z]=(0,h.useState)(!1),[E,I]=(0,h.useState)(!1),[N,D]=(0,h.useState)(!1);(0,h.useEffect)(()=>{D(!1)},[p.image]);let[H,L]=(0,h.useState)(!1),[O,U]=(0,h.useState)(!1),F=p.topics.filter(e=>"string"==typeof e&&!e.includes("<a title=")&&!e.startsWith("<")),W=F.length>0,M=p.instruments&&p.instruments.length>0,_=p.matchedVariables&&p.matchedVariables.length>0||p.allVariables&&p.allVariables.length>0,T=p.additionalLinks&&p.additionalLinks.length>0;console.log("StudyDetail instruments debug:",{instruments:p.instruments,hasInstruments:M,instrumentsLength:null===(t=p.instruments)||void 0===t?void 0:t.length});let P=(0,h.useMemo)(()=>{console.log("study var deduping :",p.matchedVariables,p);let e=p.matchedVariables||[],t=p.allVariables||[],o=new Map;return e.forEach(e=>{let t=e.uuid||e.name;t&&o.set(t,e)}),t.forEach(e=>{let t=e.uuid||e.name;!t||o.has(t)||o.set(t,e)}),Array.from(o.values())},[p.matchedVariables,p.allVariables]);return(0,n.jsxs)(l.default,{sx:{p:3,width:"100%",height:"100%",overflowY:"auto",flex:1,display:"flex",flexDirection:"column"},children:[g&&(0,n.jsx)(l.default,{sx:{display:"flex",justifyContent:"flex-end",mb:2},children:(0,n.jsx)(a.A,{size:"small",onClick:()=>L(!0),sx:{opacity:.6,"&:hover":{opacity:1},color:"text.secondary"},children:(0,n.jsx)(d.A,{size:18})})}),!g&&(0,n.jsxs)(l.default,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:2,mb:4},children:[(0,n.jsx)(l.default,{sx:{flex:1},children:(0,n.jsxs)(l.default,{sx:{display:"flex",alignItems:"flex-start",justifyContent:"space-between"},children:[(0,n.jsx)(i.default,{variant:"h4",gutterBottom:!0,sx:{flex:1,mr:1},children:p.title}),(0,n.jsx)(a.A,{size:"small",onClick:()=>L(!0),sx:{opacity:.6,"&:hover":{opacity:1},color:"text.secondary",mt:.5},children:(0,n.jsx)(d.A,{size:18})})]})}),p.image&&!N&&(0,n.jsx)(l.default,{sx:{width:100,height:100,position:"relative",borderRadius:"8px",overflow:"hidden",flexShrink:0},children:(0,n.jsx)(r.default,{src:p.image,alt:p.title,fill:!0,style:{objectFit:"contain"},onError:()=>D(!0),unoptimized:!0})})]}),p.description&&(0,n.jsxs)(l.default,{sx:{mb:4},children:[(0,n.jsxs)(s.A,{in:E,collapsedSize:"130px",children:[" ",(0,n.jsx)(j.A,{text:p.description,paragraphProps:{variant:"body1",sx:{mb:2}},compact:!0})]}),p.description.length>300&&(0,n.jsxs)(l.default,{onClick:()=>I(!E),sx:{display:"flex",alignItems:"center",color:"primary.main",cursor:"pointer",mt:1},children:[(0,n.jsx)(i.default,{variant:"body2",color:"primary",sx:{fontWeight:500,mr:1},children:E?"Show Less":"Show More"}),E?(0,n.jsx)(c.A,{size:16}):(0,n.jsx)(u.A,{size:16})]})]}),(0,n.jsxs)(l.default,{sx:{display:"flex",flexDirection:"column",gap:3,mb:4},children:[p.publisher&&(0,n.jsxs)(l.default,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,n.jsx)(i.default,{variant:"subtitle2",children:"Publisher:"}),(0,n.jsx)(m.A,{name:p.publisher.name,url:p.publisher.url,logo:p.publisher.logo})]}),p.geographicCoverage&&(0,n.jsxs)(l.default,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,n.jsx)(i.default,{variant:"subtitle2",children:"Geographic Coverage:"}),(0,n.jsx)(i.default,{children:p.geographicCoverage})]}),p.temporalCoverage&&(0,n.jsxs)(l.default,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,n.jsx)(i.default,{variant:"subtitle2",children:"Temporal Coverage:"}),(0,n.jsx)(i.default,{children:(e=>{if(!e)return"Not specified";if(e.includes("..")){let[t,o]=e.split("..");return o?"".concat(t," - ").concat(o):"".concat(t," - Present (Ongoing)")}return e})(p.temporalCoverage)})]}),p.sampleSize&&"Not specified"!==p.sampleSize&&(0,n.jsxs)(l.default,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,n.jsx)(i.default,{variant:"subtitle2",children:"Sample Size:"}),(0,n.jsx)(i.default,{children:p.sampleSize})]}),p.ageCoverage&&(0,n.jsxs)(l.default,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,n.jsx)(i.default,{variant:"subtitle2",children:"Age Coverage:"}),(0,n.jsx)(i.default,{children:p.ageCoverage})]}),p.resourceType&&(0,n.jsxs)(l.default,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,n.jsx)(i.default,{variant:"subtitle2",children:"Resource Type:"}),(0,n.jsx)(i.default,{children:p.resourceType})]}),p.studyDesign&&p.studyDesign.length>0&&(0,n.jsxs)(l.default,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,n.jsx)(i.default,{variant:"subtitle2",children:"Study Design:"}),(0,n.jsx)(i.default,{children:p.studyDesign.join(", ")})]})]}),p.funders&&p.funders.length>0&&(0,n.jsxs)(l.default,{sx:{mb:4,flexShrink:0},children:[(0,n.jsx)(i.default,{variant:"subtitle2",gutterBottom:!0,children:"Funders:"}),(0,n.jsx)(l.default,{sx:{display:"flex",overflowX:"auto",gap:2,pb:1,"&::-webkit-scrollbar":{height:6},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(0,0,0,0.2)",borderRadius:3}},children:p.funders.map((e,t)=>(0,n.jsx)(m.A,{name:e.name,url:e.url,logo:e.logo},"".concat(e.name,"-").concat(t)))})]}),p.dataCatalogs&&p.dataCatalogs.length>0&&(0,n.jsxs)(l.default,{sx:{mb:4,flexShrink:0},children:[(0,n.jsx)(i.default,{variant:"subtitle2",gutterBottom:!0,children:"Available in Data Catalogs:"}),(0,n.jsx)(l.default,{sx:{display:"flex",overflowX:"auto",gap:2,pb:1,"&::-webkit-scrollbar":{height:6},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(0,0,0,0.2)",borderRadius:3}},children:p.dataCatalogs.map((e,t)=>(0,n.jsx)(f,{name:e.name,url:e.url,logo:e.logo},"".concat(e.name,"-").concat(t)))})]}),W&&(0,n.jsxs)(l.default,{sx:{mb:4},children:[(0,n.jsx)(i.default,{variant:"subtitle2",gutterBottom:!0,children:"Topics:"}),(0,n.jsx)(l.default,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:F.map((e,t)=>(0,n.jsx)(x.A,{onClick:t=>{t.stopPropagation(),y&&y(e)},sx:{cursor:"pointer"},children:e},"topic-".concat(t)))})]}),T&&(0,n.jsxs)(l.default,{sx:{mb:4,flexShrink:0},children:[(0,n.jsx)(x.A,{fullWidth:!0,chipVariant:"secondary",endIcon:k?(0,n.jsx)(c.A,{size:16,style:{fill:"#004735",stroke:"none"}}):(0,n.jsx)(u.A,{size:16,style:{fill:"#004735",stroke:"none"}}),sx:{justifyContent:"space-between",py:2,height:"auto",mb:2},onClick:()=>z(!k),children:"Related Links & Papers"}),(0,n.jsx)(s.A,{in:k,children:k&&(0,n.jsx)(l.default,{sx:{display:"flex",flexWrap:"wrap",gap:2,mb:2,alignItems:"flex-start"},children:null===(o=p.additionalLinks)||void 0===o?void 0:o.map((e,t)=>(0,n.jsx)(l.default,{sx:{flex:"1 1 350px",minWidth:300,maxWidth:500},children:(0,n.jsx)(b.A,{url:e})},"link-".concat(t)))})})]}),M&&(0,n.jsxs)(l.default,{sx:{mb:2},children:[(0,n.jsxs)(x.A,{fullWidth:!0,chipVariant:"secondary",endIcon:O?(0,n.jsx)(c.A,{size:16,style:{fill:"#004735",stroke:"none"}}):(0,n.jsx)(u.A,{size:16,style:{fill:"#004735",stroke:"none"}}),sx:{justifyContent:"space-between",py:2,height:"auto",mb:2},onClick:()=>U(e=>!e),children:["Instruments (",p.instruments.length,")"]}),(0,n.jsx)(s.A,{in:O,children:(0,n.jsx)(l.default,{sx:{display:"flex",flexWrap:"wrap",gap:1,mt:1},children:p.instruments.map((e,t)=>(0,n.jsx)(x.A,{onClick:t=>{t.stopPropagation(),C&&C(e)},children:e},"instrument-".concat(t)))})})]}),Array.isArray(p.child_datasets)&&p.child_datasets.length>0&&(0,n.jsxs)(l.default,{sx:{mb:4},children:[(0,n.jsx)(i.default,{variant:"subtitle2",gutterBottom:!0,children:"Child Datasets:"}),(0,n.jsx)(l.default,{sx:{display:"flex",flexWrap:"wrap",gap:2,alignItems:"stretch"},children:p.child_datasets.map((e,t)=>{var o;return(0,n.jsx)(et,{dataset:e},(null===(o=e.extra_data)||void 0===o?void 0:o.uuid)||t)})})]}),(0,n.jsxs)(l.default,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,n.jsx)(x.A,{fullWidth:!0,chipVariant:"secondary",endIcon:S?(0,n.jsx)(c.A,{size:16,style:{fill:"#004735",stroke:"none"}}):(0,n.jsx)(u.A,{size:16,style:{fill:"#004735",stroke:"none"}}),sx:{justifyContent:"space-between",py:2,height:"auto"},onClick:()=>R(!S),children:"AI Summary"}),(0,n.jsx)(s.A,{in:S,children:(0,n.jsx)(l.default,{sx:{p:2,bgcolor:"rgba(0, 0, 0, 0.02)",borderRadius:2,mb:2},children:(0,n.jsx)(i.default,{children:"AI summary not available yet."})})}),_&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(x.A,{fullWidth:!0,chipVariant:"secondary",endIcon:A?(0,n.jsx)(c.A,{size:16,style:{fill:"#004735",stroke:"none"}}):(0,n.jsx)(u.A,{size:16,style:{fill:"#004735",stroke:"none"}}),sx:{justifyContent:"space-between",py:2,height:"auto"},onClick:()=>w(!A),children:"Related Variables found within study"}),(0,n.jsx)(s.A,{in:A,children:(0,n.jsx)(l.default,{sx:{p:2,bgcolor:"rgba(0, 0, 0, 0.02)",borderRadius:2,mb:2},children:(0,n.jsx)(B,{variables:P,studyName:p.title})})})]})]}),(0,n.jsx)(Y,{open:H,onClose:()=>L(!1),title:p.title,originalSearchResult:null==v?void 0:v.originalSearchResult,lookupData:null==v?void 0:v.lookupData,finalProcessedData:p})]})})},3485:(e,t,o)=>{"use strict";o.d(t,{sM:()=>i,xC:()=>s});var n=o(2818);let l={"Office for National Statistics":"ONS","National Health Service":"NHS","Department for Education":"DfE","Department of Health":"DoH","Department of Health and Social Care":"DHSC","Medical Research Council":"MRC","National Institute for Health and Care Excellence":"NICE","National Institute for Health Research":"NIHR","Economic and Social Research Council":"ESRC","Arts and Humanities Research Council":"AHRC","Biotechnology and Biological Sciences Research Council":"BBSRC","Engineering and Physical Sciences Research Council":"EPSRC","Natural Environment Research Council":"NERC","Science and Technology Facilities Council":"STFC","UK Research and Innovation":"UKRI","University College London":"UCL","University of Oxford":"Oxford","University of Cambridge":"Cambridge","Imperial College London":"Imperial","King's College London":"KCL","London School of Economics":"LSE","Edinburgh University":"Edin","University of Manchester":"Manchester","University of Bristol":"Bristol","University of Warwick":"Warwick","World Health Organization":"WHO","United Nations":"UN","European Union":"EU_flag","Organisation for Economic Co-operation and Development":"OECD","Wellcome Trust":"Wellcome","Nuffield Foundation":"Nuffield","British Heart Foundation":"BHF","Cancer Research UK":"CRUK","Alzheimer's Society":"Alzheimer","Diabetes UK":"Diabetes","National Institute of Mental Health":"NIMH","National Institutes of Health":"NIH","Centers for Disease Control and Prevention":"CDC","Social Care Institute for Excellence":"SCIE"},a={MRC:"/logos/MRC.png",ESRC:"/logos/ESRC.png",UKRI:"/logos/UKRI.png",NERC:"/logos/NERC.png",STFC:"/logos/STFC.png",AHRC:"/logos/AHRC.png",BBSRC:"/logos/BBSRC.png",EPSRC:"/logos/EPSRC.png",NIHR:"/logos/NIHR.png",BHF:"/logos/BHF.png",CRUK:"/logos/CRUK.png",Wellcome:"/logos/Wellcome.png",Nuffield:"/logos/Nuffield.png",ONS:"/logos/ONS.png",NHS:"/logos/NHS.png",DfE:"/logos/DfE.png",DHSC:"/logos/DHSC.png",DoHSC:"/logos/DHSC.png",NICE:"/logos/NICE.png",SCIE:"/logos/SCIE.png",HOUK:"/logos/HOUK.png",UCL:"/logos/UCL.png",Oxford:"/logos/Oxford.png",Cambridge:"/logos/Cambridge.png",Imperial:"/logos/Imperial.png",KCL:"/logos/KCL.png",LSE:"/logos/LSE.png",Edin:"/logos/Edin.png",NIH:"/logos/NIH.png",NIMH:"/logos/NIMH.png",NIDA:"/logos/NIDA.png",NIAAA:"/logos/NIAAA.png",NSF:"/logos/NSF.png",CDC:"/logos/CDC.png",FDA:"/logos/FDA.png",EU_flag:"/logos/EU_flag.png",EUCom:"/logos/EUCom.png",ERC:"/logos/ERC.png",H2020:"/logos/H2020.png",HorizonEU:"/logos/HorizonEU.png",WHO:"/logos/WHO.png",VR:"/logos/VR.png",BMBF:"/logos/BMBF.png",DFG:"/logos/DFG.png",CNRS:"/logos/CNRS.png",INSERM:"/logos/INSERM.png",ARC:"/logos/ARC.png",NHMRC:"/logos/NHMRC.png",CIHR:"/logos/CIHR.png",Uni:"/logos/university.png",Hosp:"/logos/hospital.png",Gov:"/logos/government.png",NGO:"/logos/ngo.png",Charity:"/logos/charity.png",Rayne:"/logos/Rayne.png",SRFound:"/logos/SRFound.png",BCTrust:"/logos/BCTrust.png",UKHF:"/logos/UKHF.png",RCN:"/logos/RCN.png",KingsFund:"/logos/KingsFund.png",MHRN:"/logos/MHRN.png",McPF:"/logos/McPF.png",BLF:"/logos/BLF.png",CLAHRC:"/logos/CLAHRC.png",TNA:"/logos/TNA.png",NAO:"/logos/NAO.png",RCP:"/logos/RCP.png",SU:"/logos/SU.png",SLaM:"/logos/SLaM.png"};function i(e,t){if(t&&t.trim().length>0)return console.log("Using provided logo for ".concat(e||"Unknown",": ").concat(t)),t;if(!e||0===e.trim().length){console.log("No organization name provided to findOrganizationLogo");return}if(e.includes(" ")&&e.split(" ").every(e=>e.length<=6)){for(let t of(console.log('Organization name "'.concat(e,'" appears to be a space-delimited list of abbreviations')),e.split(" ").map(e=>e.trim()).filter(e=>e.length>0))){if(a[t])return console.log('Found direct logo match for abbreviation "'.concat(t,'": ').concat(a[t])),a[t];for(let[e,o]of Object.entries(l))if(e.toLowerCase().includes(t.toLowerCase())||o.toLowerCase()===t.toLowerCase()){let n="/logos/".concat(o,".png");return console.log('Found partial match for "'.concat(t,'" with known organization "').concat(e,'" (').concat(o,"): ").concat(n)),n}}console.log('No logo match found for any part of "'.concat(e,'"'));return}let o=l[e];if(o){let t="/logos/".concat(o,".png");return console.log('Found direct organization match for "'.concat(e,'": ').concat(t)),t}if(a[e])return console.log('Found direct logo match for organization abbreviation "'.concat(e,'": ').concat(a[e])),a[e];for(let[t,o]of Object.entries(l))if(e.toLowerCase().includes(t.toLowerCase())||e.toLowerCase().includes(o.toLowerCase())){let n="/logos/".concat(o,".png");return console.log('Found partial match for "'.concat(e,'" with known organization "').concat(t,'": ').concat(n)),n}console.log('No logo match found for "'.concat(e,'"'))}function s(){return n.env.GITHUB_PAGES_DEPLOYMENT?"/search/":window.location.pathname.startsWith("/search")?"/search/":"/"}},67699:()=>{}}]);