(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[314],{41234:()=>{},29755:(e,t,o)=>{Promise.resolve().then(o.bind(o,91640))},91640:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>O});var n=o(95155),r=o(12115),a=o(64665),l=o(42479),s=o(68998),i=o(9561),c=o(96854),g=o(9552),d=o(10897),h=o(35417),u=o(72926),p=o(78562),f=o(41728),m=o(58581),x=o(24817),C=o(15255),y=o(12800),v=o(66963),j=o(27112),w=o(16161),b=o(90518),S=o(42649),A=o(14030),E=o(53452),k=o(65776),R=o(3485);let _={rotations:2,rotationAngles:[-90,0],fontSizes:[12,60],padding:1},N=(e,t)=>{let o="sample_size"===t,n=[...e].filter(e=>null!=e&&!isNaN(e));if(0===n.length)return{values:[],frequencies:[],labels:[]};if(o){let e=[1e3,1e4,1e5,1e6,1e7],t=["<1k","<10k","<100k","<1m","<10m"],o=Array(t.length).fill(0);return n.forEach(t=>{for(let n=0;n<e.length;n++)if(t>(0==n?0:e[n-1])&&t<=e[n]){o[n]++;break}}),{values:e,frequencies:o,labels:t}}let r=Math.min(...n),a=Math.max(...n),l=[],s=[];if(t.includes("year")){let e=5*Math.floor(r/5),t=(5*Math.ceil(a/5)-e)/5,o=Array(t).fill(0),i=Array(t).fill(0).map((t,o)=>e+5*o);n.forEach(n=>{let r=Math.floor((n-e)/5);r>=0&&r<t&&o[r]++}),l=i,s=o}else{let e=10;t.includes("age")?e=6:t.includes("duration")&&(e=5);let o=(a-r)/e,i=Array(e).fill(0),c=Array(e+1).fill(0).map((e,t)=>r+t*o);n.forEach(t=>{let n=Math.min(Math.floor((t-r)/o),e-1);i[n]++}),l=c.slice(0,-1).map((e,t)=>e+o/2),s=i}return{values:l,frequencies:s,labels:[]}},H=(e,t)=>"string"==typeof e?e:t.includes("year")?e.toString():(t.includes("num_")||t.includes("age")||t.includes("duration"),Math.round(e).toString()),U=e=>Object.entries(e).map(e=>{let[t,o]=e;return{text:t,value:100*o}}),I=e=>{let{title:t,value:o,icon:r}=e;return(0,n.jsx)(a.A,{elevation:1,sx:{height:"100%"},children:(0,n.jsxs)(l.A,{sx:{p:3,textAlign:"center"},children:[r&&(0,n.jsx)(s.default,{sx:{mb:2,display:"flex",justifyContent:"center"},children:r}),(0,n.jsx)(i.default,{variant:"h3",component:"div",sx:{mb:1,fontWeight:"bold",color:"primary.main"},children:o.toLocaleString()}),(0,n.jsx)(i.default,{variant:"body2",color:"text.secondary",children:t})]})})},F=e=>{let{filters:t}=e,[o,A]=(0,r.useState)(!0),[F,O]=(0,r.useState)(null),[D,L]=(0,r.useState)(null),[M,B]=(0,r.useState)({}),[P,W]=(0,r.useState)([]),[T,z]=(0,r.useState)(null);if((0,r.useEffect)(()=>{(async()=>{try{A(!0);let[e,o,n]=await Promise.all([(0,S.U4)(t),(0,S.Y3)(t),(0,S.dh)()]),r={};o.aggregations&&Object.entries(o.aggregations).forEach(e=>{let[t,o]=e;if(Array.isArray(o)){let{values:e,frequencies:n,labels:a}=N(o,t);r[t]={values:e,frequencies:n,labels:a,formatXAxis:e=>H(e,t)}}}),L(e),B(r),z(n);try{let e=await (0,S.AV)(t);W(U(e.aggregations))}catch(e){console.warn("Word cloud data fetch failed:",e),W([])}}catch(e){console.error("Error fetching data:",e),O(e instanceof Error?e.message:"Failed to fetch data")}finally{A(!1)}})()},[t]),o)return(0,n.jsx)(s.default,{sx:{display:"flex",justifyContent:"center",p:4},children:(0,n.jsx)(c.A,{})});if(F)return(0,n.jsx)(g.default,{maxWidth:"lg",sx:{mt:4},children:(0,n.jsx)(d.A,{severity:"error",children:F})});let K=(null==D?void 0:D.aggregations)||{},q=K.resource_type||{},G=(q.study||0)+(q.dataset||0),V=K.source||{},X=Object.keys(V).length,Y=K.keywords||{},J=Object.keys(Y).length,$=q.variable||0,Q=Object.entries(Y).map(e=>{let[t,o]=e;return{key:t,doc_count:o}}).sort((e,t)=>t.doc_count-e.doc_count).slice(0,20),Z=Object.entries(V).map(e=>{let[t,o]=e;return{key:t,doc_count:o,sourceInfo:(null==T?void 0:T[t])||null}}).sort((e,t)=>t.doc_count-e.doc_count).slice(0,4),ee=Object.entries(K.instruments||{}).map(e=>{let[t,o]=e;return{key:t,doc_count:o}}).sort((e,t)=>t.doc_count-e.doc_count).slice(0,10),et=Object.entries(K.study_design||{}).map(e=>{let[t,o]=e;return{key:t,doc_count:o}}).sort((e,t)=>t.doc_count-e.doc_count).slice(0,20);return(0,n.jsxs)(s.default,{sx:{width:"100%"},children:[(0,n.jsxs)(h.Ay,{container:!0,spacing:3,sx:{mb:4},children:[(0,n.jsx)(h.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,n.jsx)(I,{title:"Studies / Datasets",value:G})}),(0,n.jsx)(h.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,n.jsx)(I,{title:"Data Sources",value:X})}),(0,n.jsx)(h.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,n.jsx)(I,{title:"Topics",value:J})}),(0,n.jsx)(h.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,n.jsx)(I,{title:"Variables",value:$})})]}),P.length>0&&(0,n.jsx)(a.A,{elevation:1,sx:{mb:4},children:(0,n.jsxs)(l.A,{sx:{p:3},children:[(0,n.jsx)(i.default,{variant:"h6",gutterBottom:!0,children:"Popular Phrases"}),(0,n.jsx)(s.default,{sx:{height:300,width:"100%"},children:(0,n.jsx)(s.default,{sx:{width:"100%",height:"100%",position:"relative"},onClick:e=>{let t=e.target;if("text"===t.tagName||t.closest("text")){let e="text"===t.tagName?t:t.closest("text");if(e){let t=e.textContent;if(t){let e="".concat((0,R.xC)(),"?query=").concat(encodeURIComponent(t));window.open(e,"_blank")}}}},onMouseOver:e=>{let t=e.target;if("text"===t.tagName||t.closest("text")){let e="text"===t.tagName?t:t.closest("text");if(e){let t=e.textContent;t&&(e.title='Click to search for "'.concat(t,'"'))}}},children:(0,n.jsx)(f.Ay,{words:P,options:_,minSize:[300,300],callbacks:{onWordClick:e=>{let t="".concat((0,R.xC)(),"?query=").concat(encodeURIComponent(e.text));window.open(t,"_blank")},getWordTooltip:e=>'Click to search for "'.concat(e.text,'"')}})})})]})}),(0,n.jsxs)(h.Ay,{container:!0,spacing:3,sx:{mb:4},children:[Q.length>0&&(0,n.jsx)(h.Ay,{item:!0,xs:12,md:6,children:(0,n.jsx)(a.A,{elevation:1,sx:{height:"100%"},children:(0,n.jsxs)(l.A,{sx:{p:3},children:[(0,n.jsx)(i.default,{variant:"h6",gutterBottom:!0,children:"Popular Topics"}),(0,n.jsx)(s.default,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:Q.map((e,t)=>(0,n.jsx)(u.A,{title:'Click to search for "'.concat(e.key,'"'),children:(0,n.jsx)("span",{children:(0,n.jsx)(E.A,{sx:{cursor:"pointer"},onClick:()=>{let t="".concat((0,R.xC)(),"?topics=").concat(encodeURIComponent(e.key));window.open(t,"_blank")},children:e.key})})},"keyword-tooltip-".concat(t)))})]})})}),Z.length>0&&(0,n.jsx)(h.Ay,{item:!0,xs:12,md:6,children:(0,n.jsx)(a.A,{elevation:1,sx:{height:"100%"},children:(0,n.jsxs)(l.A,{sx:{p:3},children:[(0,n.jsx)(i.default,{variant:"h6",gutterBottom:!0,children:"Popular Data Sources"}),(0,n.jsx)(h.Ay,{container:!0,spacing:2,children:Z.map((e,t)=>{var o,r,a;return(0,n.jsx)(h.Ay,{item:!0,xs:12,sm:6,children:(0,n.jsx)(k.A,{name:(null===(o=e.sourceInfo)||void 0===o?void 0:o.name)||e.key,url:null===(r=e.sourceInfo)||void 0===r?void 0:r.url,logo:null===(a=e.sourceInfo)||void 0===a?void 0:a.logo,compact:!1})},"source-".concat(t))})})]})})})]}),(0,n.jsxs)(h.Ay,{container:!0,spacing:3,sx:{mb:4},children:[ee.length>0&&(0,n.jsx)(h.Ay,{item:!0,xs:12,md:6,children:(0,n.jsx)(a.A,{elevation:1,sx:{height:"100%"},children:(0,n.jsxs)(l.A,{sx:{p:3},children:[(0,n.jsx)(i.default,{variant:"h6",gutterBottom:!0,children:"Popular Instruments"}),(0,n.jsx)(s.default,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:ee.map((e,t)=>(0,n.jsx)(u.A,{title:'Click to search for "'.concat(e.key,'"'),children:(0,n.jsx)("span",{children:(0,n.jsx)(E.A,{sx:{cursor:"pointer"},onClick:()=>{let t="".concat((0,R.xC)(),"?instruments=").concat(encodeURIComponent(e.key));window.open(t,"_blank")},children:e.key})})},"instrument-tooltip-".concat(t)))})]})})}),et.length>0&&(0,n.jsx)(h.Ay,{item:!0,xs:12,md:6,children:(0,n.jsx)(a.A,{elevation:1,sx:{height:"100%"},children:(0,n.jsxs)(l.A,{sx:{p:3},children:[(0,n.jsx)(i.default,{variant:"h6",gutterBottom:!0,children:"Popular Study Designs"}),(0,n.jsx)(s.default,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:et.map((e,t)=>(0,n.jsx)(u.A,{title:'Click to search for "'.concat(e.key,'"'),children:(0,n.jsx)("span",{children:(0,n.jsx)(E.A,{sx:{cursor:"pointer"},onClick:()=>{let t="".concat((0,R.xC)(),"?study_design=").concat(encodeURIComponent(e.key));window.open(t,"_blank")},children:e.key})})},"design-tooltip-".concat(t)))})]})})})]}),M&&Object.entries(M).length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.default,{variant:"h5",component:"h2",gutterBottom:!0,sx:{mb:3,fontWeight:"bold"},children:"Distribution Analysis"}),(0,n.jsx)(h.Ay,{container:!0,spacing:3,sx:{mb:4},children:Object.entries(M).filter(e=>{let[t,o]=e;return o.values.length>0}).map(e=>{let[t,o]=e,r=o.values.map((e,t)=>({value:e,frequency:o.frequencies[t],name:o.labels&&o.labels.length?o.labels[t]:o.formatXAxis?o.formatXAxis(e):e.toString()}));return console.log("Chart data for ",t,":",r),(0,n.jsx)(h.Ay,{item:!0,xs:12,md:6,children:(0,n.jsxs)(p.A,{sx:{p:3,width:"100%"},children:[(0,n.jsxs)(i.default,{variant:"h6",gutterBottom:!0,children:[t.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())," ","Distribution (",r.reduce((e,t)=>e+t.frequency,0)," ","datasets)"]}),(0,n.jsx)(s.default,{sx:{width:"100%",minHeight:250},children:(0,n.jsx)(m.u,{width:"100%",aspect:2,children:(0,n.jsxs)(x.b,{data:r,margin:{top:20,right:30,left:20,bottom:5},children:[(0,n.jsx)(C.d,{strokeDasharray:"3 3"}),(0,n.jsx)(y.W,{dataKey:"value",tick:{fontSize:12},interval:"preserveStartEnd",type:"number",domain:[r[0].value,r[r.length-1].value],allowDecimals:!1,scale:"sample_size"!==t?"linear":"log",tickFormatter:e=>{let t=r.find(t=>t.value===e);return t?t.name:e.toString()}}),(0,n.jsx)(v.h,{tick:{fontSize:12},label:{value:"Frequency",angle:-90,position:"insideLeft",style:{fontSize:12}}}),(0,n.jsx)(j.m,{}),(0,n.jsx)(w.N,{type:"monotone",dataKey:"frequency",stroke:"#8884d8",strokeWidth:2,dot:!1,activeDot:{r:8}}),(0,n.jsx)(b.G,{type:"monotone",dataKey:"frequency",fill:"#8884d8",fillOpacity:.1})]})})})]})},t)})})]})]})};function O(){let[e,t]=(0,r.useState)({}),[o,a]=(0,r.useState)([]),l=function(e,t){let[o,n]=(0,r.useState)(e);return(0,r.useEffect)(()=>{let t=setTimeout(()=>{n(e)},500);return()=>{clearTimeout(t)}},[e,500]),o}(e,0);(0,r.useEffect)(()=>{(async()=>{try{let e=await (0,S.Dd)();a(e)}catch(e){console.error("Error fetching filters:",e)}})()},[]);let c=(0,r.useCallback)((e,o)=>{t(t=>({...t,[e]:o}))},[]);return(0,n.jsxs)(g.default,{maxWidth:!1,sx:{mt:4,width:"100%",px:{xs:0,sm:2}},children:[(0,n.jsx)(s.default,{sx:{mb:4},children:(0,n.jsx)(A.A,{filtersData:o,onSelectionChange:c,selectedFilters:e})}),(0,n.jsx)(i.default,{variant:"h4",component:"h1",gutterBottom:!0,sx:{mb:4,fontWeight:"bold"},children:"Meta Data Explorer"}),(0,n.jsx)(F,{filters:l})]})}},65776:(e,t,o)=>{"use strict";o.d(t,{A:()=>g});var n=o(95155),r=o(64665),a=o(68998),l=o(9561),s=o(5565),i=o(3485),c=o(12115);function g(e){let{name:t,url:o,logo:g,inactive:d,compact:h}=e,[u,p]=(0,c.useState)(g),[f,m]=(0,c.useState)(!1);(0,c.useEffect)(()=>{console.log('Resolving logo for organization: "'.concat(t,'"'));try{let e=(0,i.sM)(t,g);console.log('Resolved logo for organization "'.concat(t,'":'),e),p(e),m(!1)}catch(e){console.error('Error resolving logo for organization "'.concat(t,'":'),e),p(void 0)}},[t,g]);let x=u&&u.length>0&&!f;return(0,n.jsxs)(r.A,{elevation:0,sx:{display:"flex",borderRadius:"16px",overflow:"hidden",width:h?"220px":"280px",height:h?"75px":"85px",flexShrink:0,border:"1px solid",borderColor:"grey.200",cursor:o?"pointer":"default",transition:"all 0.2s",opacity:d?.5:1,"&:hover":o?{boxShadow:2,borderColor:"primary.main"}:{}},onClick:()=>{o&&window.open(o,"_blank","noopener,noreferrer")},children:[(0,n.jsx)(a.default,{sx:{flex:1,bgcolor:"rgba(0,0,0,0.03)",p:2,display:"flex",flexDirection:"column",justifyContent:"center"},children:(0,n.jsx)(l.default,{sx:{fontWeight:500,fontSize:h?"0.8rem":"0.9rem",lineHeight:1.2,overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",maxHeight:"3.9em",wordBreak:"break-word",paddingBottom:"1px"},children:t})}),x&&(0,n.jsx)(a.default,{sx:{width:"30%",bgcolor:"white",display:"flex",alignItems:"center",justifyContent:"center",p:1,borderLeft:"1px solid",borderColor:"grey.200"},children:(0,n.jsx)(s.default,{src:u,alt:t,width:h?40:50,height:h?40:50,style:{objectFit:"contain"},onError:()=>{console.error('Error loading image for organization "'.concat(t,'" from path: ').concat(u)),m(!0)},unoptimized:!0})})]})}},53452:(e,t,o)=>{"use strict";o.d(t,{A:()=>r});var n=o(22282);let r=(0,o(89142).Ay)(n.A,{shouldForwardProp:e=>"chipVariant"!==e})(e=>{let{theme:t,chipVariant:o="primary",onClick:n=()=>{}}=e;return{onClick:n,borderRadius:8,textTransform:"none",padding:"0 16px",height:32,minHeight:32,fontSize:"0.875rem",fontWeight:500,whiteSpace:"nowrap",lineHeight:1,..."primary"===o&&{backgroundColor:t.palette.primary.main,color:t.palette.primary.contrastText,"&:hover":{backgroundColor:t.palette.primary.dark}},..."secondary"===o&&{backgroundColor:t.palette.secondary.main,color:t.palette.secondary.contrastText,"&:hover":{backgroundColor:t.palette.secondary.dark}},..."dark"===o&&{backgroundColor:"#444653",color:"#FFFFFF","&:hover":{backgroundColor:"#363742"}}}})},3485:(e,t,o)=>{"use strict";o.d(t,{sM:()=>l,xC:()=>s});var n=o(2818);let r={"Office for National Statistics":"ONS","National Health Service":"NHS","Department for Education":"DfE","Department of Health":"DoH","Department of Health and Social Care":"DHSC","Medical Research Council":"MRC","National Institute for Health and Care Excellence":"NICE","National Institute for Health Research":"NIHR","Economic and Social Research Council":"ESRC","Arts and Humanities Research Council":"AHRC","Biotechnology and Biological Sciences Research Council":"BBSRC","Engineering and Physical Sciences Research Council":"EPSRC","Natural Environment Research Council":"NERC","Science and Technology Facilities Council":"STFC","UK Research and Innovation":"UKRI","University College London":"UCL","University of Oxford":"Oxford","University of Cambridge":"Cambridge","Imperial College London":"Imperial","King's College London":"KCL","London School of Economics":"LSE","Edinburgh University":"Edin","University of Manchester":"Manchester","University of Bristol":"Bristol","University of Warwick":"Warwick","World Health Organization":"WHO","United Nations":"UN","European Union":"EU_flag","Organisation for Economic Co-operation and Development":"OECD","Wellcome Trust":"Wellcome","Nuffield Foundation":"Nuffield","British Heart Foundation":"BHF","Cancer Research UK":"CRUK","Alzheimer's Society":"Alzheimer","Diabetes UK":"Diabetes","National Institute of Mental Health":"NIMH","National Institutes of Health":"NIH","Centers for Disease Control and Prevention":"CDC","Social Care Institute for Excellence":"SCIE"},a={MRC:"/logos/MRC.png",ESRC:"/logos/ESRC.png",UKRI:"/logos/UKRI.png",NERC:"/logos/NERC.png",STFC:"/logos/STFC.png",AHRC:"/logos/AHRC.png",BBSRC:"/logos/BBSRC.png",EPSRC:"/logos/EPSRC.png",NIHR:"/logos/NIHR.png",BHF:"/logos/BHF.png",CRUK:"/logos/CRUK.png",Wellcome:"/logos/Wellcome.png",Nuffield:"/logos/Nuffield.png",ONS:"/logos/ONS.png",NHS:"/logos/NHS.png",DfE:"/logos/DfE.png",DHSC:"/logos/DHSC.png",DoHSC:"/logos/DHSC.png",NICE:"/logos/NICE.png",SCIE:"/logos/SCIE.png",HOUK:"/logos/HOUK.png",UCL:"/logos/UCL.png",Oxford:"/logos/Oxford.png",Cambridge:"/logos/Cambridge.png",Imperial:"/logos/Imperial.png",KCL:"/logos/KCL.png",LSE:"/logos/LSE.png",Edin:"/logos/Edin.png",NIH:"/logos/NIH.png",NIMH:"/logos/NIMH.png",NIDA:"/logos/NIDA.png",NIAAA:"/logos/NIAAA.png",NSF:"/logos/NSF.png",CDC:"/logos/CDC.png",FDA:"/logos/FDA.png",EU_flag:"/logos/EU_flag.png",EUCom:"/logos/EUCom.png",ERC:"/logos/ERC.png",H2020:"/logos/H2020.png",HorizonEU:"/logos/HorizonEU.png",WHO:"/logos/WHO.png",VR:"/logos/VR.png",BMBF:"/logos/BMBF.png",DFG:"/logos/DFG.png",CNRS:"/logos/CNRS.png",INSERM:"/logos/INSERM.png",ARC:"/logos/ARC.png",NHMRC:"/logos/NHMRC.png",CIHR:"/logos/CIHR.png",Uni:"/logos/university.png",Hosp:"/logos/hospital.png",Gov:"/logos/government.png",NGO:"/logos/ngo.png",Charity:"/logos/charity.png",Rayne:"/logos/Rayne.png",SRFound:"/logos/SRFound.png",BCTrust:"/logos/BCTrust.png",UKHF:"/logos/UKHF.png",RCN:"/logos/RCN.png",KingsFund:"/logos/KingsFund.png",MHRN:"/logos/MHRN.png",McPF:"/logos/McPF.png",BLF:"/logos/BLF.png",CLAHRC:"/logos/CLAHRC.png",TNA:"/logos/TNA.png",NAO:"/logos/NAO.png",RCP:"/logos/RCP.png",SU:"/logos/SU.png",SLaM:"/logos/SLaM.png"};function l(e,t){if(t&&t.trim().length>0)return console.log("Using provided logo for ".concat(e||"Unknown",": ").concat(t)),t;if(!e||0===e.trim().length){console.log("No organization name provided to findOrganizationLogo");return}if(e.includes(" ")&&e.split(" ").every(e=>e.length<=6)){for(let t of(console.log('Organization name "'.concat(e,'" appears to be a space-delimited list of abbreviations')),e.split(" ").map(e=>e.trim()).filter(e=>e.length>0))){if(a[t])return console.log('Found direct logo match for abbreviation "'.concat(t,'": ').concat(a[t])),a[t];for(let[e,o]of Object.entries(r))if(e.toLowerCase().includes(t.toLowerCase())||o.toLowerCase()===t.toLowerCase()){let n="/logos/".concat(o,".png");return console.log('Found partial match for "'.concat(t,'" with known organization "').concat(e,'" (').concat(o,"): ").concat(n)),n}}console.log('No logo match found for any part of "'.concat(e,'"'));return}let o=r[e];if(o){let t="/logos/".concat(o,".png");return console.log('Found direct organization match for "'.concat(e,'": ').concat(t)),t}if(a[e])return console.log('Found direct logo match for organization abbreviation "'.concat(e,'": ').concat(a[e])),a[e];for(let[t,o]of Object.entries(r))if(e.toLowerCase().includes(t.toLowerCase())||e.toLowerCase().includes(o.toLowerCase())){let n="/logos/".concat(o,".png");return console.log('Found partial match for "'.concat(e,'" with known organization "').concat(t,'": ').concat(n)),n}console.log('No logo match found for "'.concat(e,'"'))}function s(){return n.env.GITHUB_PAGES_DEPLOYMENT?"/search/":window.location.pathname.startsWith("/search")?"/search/":"/"}},42649:(e,t,o)=>{"use strict";o.d(t,{AV:()=>d,Dd:()=>r,Hu:()=>a,Pn:()=>i,U4:()=>c,Y3:()=>g,dh:()=>h,v5:()=>s,w3:()=>l});let n="https://harmonydataweaviate.azureedge.net";async function r(){let e=await fetch("".concat(n,"/discover/aggregate"),{method:"GET"});if(!e.ok){let t=await e.text();throw console.error("fetchAggregateFilters error. Status:",e.status,"Response:",t),Error("Failed to fetch aggregate filters")}let t=await e.json();window.__lastAggregateResponse=t,console.log("Aggregate API response cached in window.__lastAggregateResponse for debugging"),console.log("Aggregate response:",{aggregationKeys:Object.keys(t.aggregations||{}),sampleKeys:Object.keys(t.aggregations||{}).slice(0,3).map(e=>({key:e,value:t.aggregations[e]}))});let o=t.aggregations||{};return Object.keys(o).map(e=>({id:e,label:e.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" "),options:Object.keys(o[e])}))}async function a(e,t){var o,r;let a,l,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:40,c=!(arguments.length>4)||void 0===arguments[4]||arguments[4],g=arguments.length>5?arguments[5]:void 0,d=arguments.length>6?arguments[6]:void 0,h=arguments.length>7?arguments[7]:void 0,u=t&&Object.keys(t).length>0;if(!e&&!u)return{results:[],aggregations:{},num_hits:0};let p=e&&""!==e.trim()?e.trim():"",f=d&&d.length>0&&!c,m=c?"search2":"search",x="".concat(n,"/discover/").concat(m);if(f){a=x;let e={query:[p],num_results:i},o=void 0!==h?h:(s-1)*i;e.offset=o,void 0!==g&&(e.alpha=g),e.top_level_ids_seen_so_far=d,t&&Object.entries(t).forEach(t=>{let[o,n]=t;n.length>0&&(e[o]=n)}),l={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)},console.log("Using POST request for pagination with body:",{query:[p],topLevelIdsCount:d.length,offset:o,endpoint:m})}else{let e=new URLSearchParams;void 0!==g&&e.set("alpha",g.toString()),e.append("query",p);let o=void 0!==h?h:(s-1)*i;e.set("num_results",i.toString()),e.set("offset",o.toString());let n={};if(t)for(let o in t)if(o.endsWith("_min")||o.endsWith("_max")){let r=o.replace(/_(min|max)$/,"");n[r]||(n[r]={}),o.endsWith("_min")?n[r].min=t[o][0]:n[r].max=t[o][0],e.append(o,t[o][0])}else t[o].forEach(t=>{e.append(o,t)});a="".concat(x,"?").concat(e.toString()),l={method:"GET"},Object.keys(n).length>0&&console.log("Numeric range parameters:",n),console.log("Using GET request:",a)}let C=await fetch(a,l);if(!C.ok)throw console.error("Search API error:",C.status,await C.text()),Error("Search API request failed");let y=await C.json();return window.__lastSearchResponse=y,console.log("Search API response cached in window.__lastSearchResponse for debugging"),console.log("Search results:",{totalHits:y.num_hits,resultCount:(null===(o=y.results)||void 0===o?void 0:o.length)||0,firstResult:null===(r=y.results)||void 0===r?void 0:r[0],aggregations:Object.keys(y.aggregations||{}),endpoint:m,method:f?"POST":"GET",hybridWeight:g}),{results:y.results||[],aggregations:y.aggregations||{},num_hits:y.num_hits,top_level_ids_seen_so_far:y.top_level_ids_seen_so_far||[],next_page_offset:y.next_page_offset}}async function l(e){let t="".concat(n,"/discover/lookup?uuid=").concat(e),o=await fetch(t);if(!o.ok)throw console.error("Failed to fetch result by UUID:",o.statusText),Error("Failed to fetch result by UUID: ".concat(o.statusText));let r=await o.json();return window.__lastLookupResponse=r,r.results[0]}async function s(e){let t=await fetch("https://harmonydata.azureedge.net/api/ogData?url=".concat(encodeURIComponent(e)));if(!t.ok)throw Error("Failed to fetch OpenGraph data");return t.json()}async function i(){let e=await fetch("".concat(n,"/info/version"));if(!e.ok)throw console.error("Failed to fetch version info:",e.statusText),Error("Failed to fetch version info");let t=await e.json();return window.__lastVersionResponse=t,console.log("Version API response cached in window.__lastVersionResponse for debugging"),t}async function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URLSearchParams;Object.entries(e).forEach(e=>{let[o,n]=e;n.length>0&&n.forEach(e=>{t.append(o,e)})});let o=await fetch("".concat(n,"/discover/aggregate?").concat(t.toString()),{headers:{accept:"application/json"}});if(!o.ok)throw Error("Failed to fetch aggregate data");return o.json()}async function g(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URLSearchParams;Object.entries(e).forEach(e=>{let[o,n]=e;n.length>0&&n.forEach(e=>{t.append(o,e)})});let o=await fetch("".concat(n,"/discover/get_numeric_values?").concat(t.toString()),{headers:{accept:"application/json"}});if(!o.ok)throw Error("Failed to fetch numeric values");return o.json()}async function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URLSearchParams;Object.entries(e).forEach(e=>{let[o,n]=e;n.length>0&&n.forEach(e=>{t.append(o,e)})});let o=await fetch("".concat(n,"/discover/get_word_cloud?").concat(t.toString()),{headers:{accept:"application/json"}});if(!o.ok)throw Error("Failed to fetch word cloud data");return o.json()}async function h(){let e=await fetch("".concat(n,"/discover/sources"),{headers:{accept:"application/json"}});if(!e.ok)throw Error("Failed to fetch sources data");return e.json()}}},e=>{var t=t=>e(e.s=t);e.O(0,[380,679,565,282,26,152,512,476,891,417,267,30,441,517,358],()=>t(29755)),_N_E=e.O()}]);