(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[314],{41234:()=>{},29755:(e,t,a)=>{Promise.resolve().then(a.bind(a,91640))},91640:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>q});var r=a(95155),l=a(12115),s=a(68998),i=a(96854),n=a(9552),o=a(10897),c=a(35417),d=a(9561),u=a(78562),h=a(41728),f=a(58581),x=a(24817),m=a(15255),g=a(12800),y=a(66963),j=a(27112),p=a(16161),b=a(90518),v=a(42649),A=a(14030);let w={rotations:2,rotationAngles:[-90,0],fontSizes:[12,60],padding:1},S=(e,t)=>{let a="sample_size"===t,r=[...e].filter(e=>null!=e&&!isNaN(e));if(0===r.length)return{values:[],frequencies:[],labels:[]};if(a){let e=[1e3,1e4,1e5,1e6,1e7],t=["<1k","<10k","<100k","<1m","<10m"],a=Array(t.length).fill(0);return r.forEach(t=>{for(let r=0;r<e.length;r++)if(t>(0==r?0:e[r-1])&&t<=e[r]){a[r]++;break}}),{values:e,frequencies:a,labels:t}}let l=Math.min(...r),s=Math.max(...r),i=[],n=[];if(t.includes("year")){let e=5*Math.floor(l/5),t=(5*Math.ceil(s/5)-e)/5,a=Array(t).fill(0),o=Array(t).fill(0).map((t,a)=>e+5*a);r.forEach(r=>{let l=Math.floor((r-e)/5);l>=0&&l<t&&a[l]++}),i=o,n=a}else{let e=10;t.includes("age")?e=6:t.includes("duration")&&(e=5);let a=(s-l)/e,o=Array(e).fill(0),c=Array(e+1).fill(0).map((e,t)=>l+t*a);r.forEach(t=>{let r=Math.min(Math.floor((t-l)/a),e-1);o[r]++}),i=c.slice(0,-1).map((e,t)=>e+a/2),n=o}return{values:i,frequencies:n,labels:[]}},k=(e,t)=>"string"==typeof e?e:t.includes("year")?e.toString():(t.includes("num_")||t.includes("age")||t.includes("duration"),Math.round(e).toString()),E=e=>Object.entries(e).map(e=>{let[t,a]=e;return{text:t,value:100*a}}),_=e=>{let{filters:t}=e,[a,A]=(0,l.useState)(!0),[_,q]=(0,l.useState)(null),[C,M]=(0,l.useState)(null),[z,O]=(0,l.useState)({}),[D,N]=(0,l.useState)([]);return((0,l.useEffect)(()=>{(async()=>{try{A(!0);let[e,a]=await Promise.all([(0,v.U4)(t),(0,v.Y3)(t)]),r={};a.aggregations&&Object.entries(a.aggregations).forEach(e=>{let[t,a]=e;if(Array.isArray(a)){let{values:e,frequencies:l,labels:s}=S(a,t);r[t]={values:e,frequencies:l,labels:s,formatXAxis:e=>k(e,t)}}}),M(e),O(r);try{let e=await (0,v.AV)(t);N(E(e.aggregations))}catch(e){console.warn("Word cloud data fetch failed:",e),N([])}}catch(e){console.error("Error fetching data:",e),q(e instanceof Error?e.message:"Failed to fetch data")}finally{A(!1)}})()},[t]),a)?(0,r.jsx)(s.default,{sx:{display:"flex",justifyContent:"center",p:4},children:(0,r.jsx)(i.A,{})}):_?(0,r.jsx)(n.default,{maxWidth:"lg",sx:{mt:4},children:(0,r.jsx)(o.A,{severity:"error",children:_})}):(0,r.jsxs)(c.Ay,{container:!0,spacing:4,sx:{width:"100%",margin:0},children:[D.length>0&&(0,r.jsxs)(c.Ay,{item:!0,xs:12,sx:{width:"100%"},children:[(0,r.jsx)(d.default,{variant:"h6",gutterBottom:!0,children:"Word Cloud"}),(0,r.jsx)(s.default,{sx:{height:300,width:"100%"},children:(0,r.jsx)(s.default,{sx:{width:"100%",height:"100%",position:"relative"},children:(0,r.jsx)(h.Ay,{words:D,options:w,minSize:[300,300]})})})]}),(0,r.jsx)(c.Ay,{item:!0,xs:12,sx:{width:"100%"},children:z&&Object.entries(z).length>0&&(0,r.jsx)(c.Ay,{container:!0,spacing:3,sx:{width:"100%",margin:0},children:Object.entries(z).filter(e=>{let[t,a]=e;return a.values.length>0}).map(e=>{let[t,a]=e,l=a.values.map((e,t)=>({value:e,frequency:a.frequencies[t],name:a.labels&&a.labels.length?a.labels[t]:a.formatXAxis?a.formatXAxis(e):e.toString()}));return console.log("Chart data for ",t,":",l),(0,r.jsx)(c.Ay,{item:!0,xs:12,md:6,children:(0,r.jsxs)(u.A,{sx:{p:3,width:"100%"},children:[(0,r.jsxs)(d.default,{variant:"h6",gutterBottom:!0,children:[t.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())," ","Distribution (",l.reduce((e,t)=>e+t.frequency,0)," ","datasets)"]}),(0,r.jsx)(s.default,{sx:{width:"100%",minHeight:250},children:(0,r.jsx)(f.u,{width:"100%",aspect:2,children:(0,r.jsxs)(x.b,{data:l,margin:{top:20,right:30,left:20,bottom:5},children:[(0,r.jsx)(m.d,{strokeDasharray:"3 3"}),(0,r.jsx)(g.W,{dataKey:"value",tick:{fontSize:12},interval:"preserveStartEnd",type:"number",domain:[l[0].value,l[l.length-1].value],allowDecimals:!1,scale:"sample_size"!==t?"linear":"log",tickFormatter:e=>{let t=l.find(t=>t.value===e);return t?t.name:e.toString()}}),(0,r.jsx)(y.h,{tick:{fontSize:12},label:{value:"Frequency",angle:-90,position:"insideLeft",style:{fontSize:12}}}),(0,r.jsx)(j.m,{}),(0,r.jsx)(p.N,{type:"monotone",dataKey:"frequency",stroke:"#8884d8",strokeWidth:2,dot:!1,activeDot:{r:8}}),(0,r.jsx)(b.G,{type:"monotone",dataKey:"frequency",fill:"#8884d8",fillOpacity:.1})]})})})]})},t)})})})]})};function q(){let[e,t]=(0,l.useState)({}),[a,i]=(0,l.useState)([]),o=function(e,t){let[a,r]=(0,l.useState)(e);return(0,l.useEffect)(()=>{let t=setTimeout(()=>{r(e)},500);return()=>{clearTimeout(t)}},[e,500]),a}(e,0);(0,l.useEffect)(()=>{(async()=>{try{let e=await (0,v.Dd)();i(e)}catch(e){console.error("Error fetching filters:",e)}})()},[]);let c=(0,l.useCallback)((e,a)=>{t(t=>({...t,[e]:a}))},[]);return(0,r.jsxs)(n.default,{maxWidth:!1,sx:{mt:4,width:"100%",px:{xs:0,sm:2}},children:[(0,r.jsx)(s.default,{sx:{mb:4},children:(0,r.jsx)(A.A,{filtersData:a,onSelectionChange:c,selectedFilters:e})}),(0,r.jsx)(_,{filters:o})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[380,679,282,189,152,234,557,417,267,30,441,517,358],()=>t(29755)),_N_E=e.O()}]);