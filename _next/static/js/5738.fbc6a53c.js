"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5738],{51691:(e,t,o)=>{o.d(t,{sM:()=>r,xC:()=>s});var n=o(95704);let a={"Office for National Statistics":"ONS","National Health Service":"NHS","Department for Education":"DfE","Department of Health":"DoH","Department of Health and Social Care":"DHSC","Medical Research Council":"MRC","National Institute for Health and Care Excellence":"NICE","National Institute for Health Research":"NIHR","Economic and Social Research Council":"ESRC","Arts and Humanities Research Council":"AHRC","Biotechnology and Biological Sciences Research Council":"BBSRC","Engineering and Physical Sciences Research Council":"EPSRC","Natural Environment Research Council":"NERC","Science and Technology Facilities Council":"STFC","UK Research and Innovation":"UKRI","University College London":"UCL","University of Oxford":"Oxford","University of Cambridge":"Cambridge","Imperial College London":"Imperial","King's College London":"KCL","London School of Economics":"LSE","Edinburgh University":"Edin","University of Manchester":"Manchester","University of Bristol":"Bristol","University of Warwick":"Warwick","World Health Organization":"WHO","United Nations":"UN","European Union":"EU_flag","Organisation for Economic Co-operation and Development":"OECD","Wellcome Trust":"Wellcome","Nuffield Foundation":"Nuffield","British Heart Foundation":"BHF","Cancer Research UK":"CRUK","Alzheimer's Society":"Alzheimer","Diabetes UK":"Diabetes","National Institute of Mental Health":"NIMH","National Institutes of Health":"NIH","Centers for Disease Control and Prevention":"CDC","Social Care Institute for Excellence":"SCIE"},i={MRC:"/logos/MRC.png",ESRC:"/logos/ESRC.png",UKRI:"/logos/UKRI.png",NERC:"/logos/NERC.png",STFC:"/logos/STFC.png",AHRC:"/logos/AHRC.png",BBSRC:"/logos/BBSRC.png",EPSRC:"/logos/EPSRC.png",NIHR:"/logos/NIHR.png",BHF:"/logos/BHF.png",CRUK:"/logos/CRUK.png",Wellcome:"/logos/Wellcome.png",Nuffield:"/logos/Nuffield.png",ONS:"/logos/ONS.png",NHS:"/logos/NHS.png",DfE:"/logos/DfE.png",DHSC:"/logos/DHSC.png",DoHSC:"/logos/DHSC.png",NICE:"/logos/NICE.png",SCIE:"/logos/SCIE.png",HOUK:"/logos/HOUK.png",UCL:"/logos/UCL.png",Oxford:"/logos/Oxford.png",Cambridge:"/logos/Cambridge.png",Imperial:"/logos/Imperial.png",KCL:"/logos/KCL.png",LSE:"/logos/LSE.png",Edin:"/logos/Edin.png",NIH:"/logos/NIH.png",NIMH:"/logos/NIMH.png",NIDA:"/logos/NIDA.png",NIAAA:"/logos/NIAAA.png",NSF:"/logos/NSF.png",CDC:"/logos/CDC.png",FDA:"/logos/FDA.png",EU_flag:"/logos/EU_flag.png",EUCom:"/logos/EUCom.png",ERC:"/logos/ERC.png",H2020:"/logos/H2020.png",HorizonEU:"/logos/HorizonEU.png",WHO:"/logos/WHO.png",VR:"/logos/VR.png",BMBF:"/logos/BMBF.png",DFG:"/logos/DFG.png",CNRS:"/logos/CNRS.png",INSERM:"/logos/INSERM.png",ARC:"/logos/ARC.png",NHMRC:"/logos/NHMRC.png",CIHR:"/logos/CIHR.png",Uni:"/logos/university.png",Hosp:"/logos/hospital.png",Gov:"/logos/government.png",NGO:"/logos/ngo.png",Charity:"/logos/charity.png",Rayne:"/logos/Rayne.png",SRFound:"/logos/SRFound.png",BCTrust:"/logos/BCTrust.png",UKHF:"/logos/UKHF.png",RCN:"/logos/RCN.png",KingsFund:"/logos/KingsFund.png",MHRN:"/logos/MHRN.png",McPF:"/logos/McPF.png",BLF:"/logos/BLF.png",CLAHRC:"/logos/CLAHRC.png",TNA:"/logos/TNA.png",NAO:"/logos/NAO.png",RCP:"/logos/RCP.png",SU:"/logos/SU.png",SLaM:"/logos/SLaM.png"};function r(e,t){if(t&&t.trim().length>0)return t;if(!e||0===e.trim().length)return void console.log("No organization name provided to findOrganizationLogo");if(e.includes(" ")&&e.split(" ").every(e=>e.length<=6)){for(let t of(console.log('Organization name "'.concat(e,'" appears to be a space-delimited list of abbreviations')),e.split(" ").map(e=>e.trim()).filter(e=>e.length>0))){if(i[t])return console.log('Found direct logo match for abbreviation "'.concat(t,'": ').concat(i[t])),i[t];for(let[e,o]of Object.entries(a))if(e.toLowerCase().includes(t.toLowerCase())||o.toLowerCase()===t.toLowerCase())return"/logos/".concat(o,".png")}console.log('No logo match found for any part of "'.concat(e,'"'));return}let o=a[e];if(o){let t="/logos/".concat(o,".png");return console.log('Found direct organization match for "'.concat(e,'": ').concat(t)),t}if(i[e])return console.log('Found direct logo match for organization abbreviation "'.concat(e,'": ').concat(i[e])),i[e];for(let[t,o]of Object.entries(a))if(e.toLowerCase().includes(t.toLowerCase())||e.toLowerCase().includes(o.toLowerCase())){let n="/logos/".concat(o,".png");return console.log('Found partial match for "'.concat(e,'" with known organization "').concat(t,'": ').concat(n)),n}console.log('No logo match found for "'.concat(e,'"'))}function s(){return n.env.GITHUB_PAGES_DEPLOYMENT||window.location.pathname.startsWith("/search")?"/search/":"/"}},92114:(e,t,o)=>{o.d(t,{S:()=>h,SearchProvider:()=>u});var n=o(95155),a=o(12115),i=o(20063);let r={query:"",debouncedQuery:"",selectedFilters:{},useSearch2:!1,hybridWeight:.5,maxDistance:.5,maxDistanceMode:"both",directMatchWeight:.5,paginationStrategy:"trust_estimate",selectedCategory:null,resourceType:null,similarUid:null},s=(0,a.createContext)({searchSettings:r,updateQuery:()=>{console.warn("Search not available on server")},updateSearchSettings:()=>{console.warn("Search not available on server")},resetSearchSettings:()=>{console.warn("Search not available on server")},loadSearchFromSaved:()=>{console.warn("Search not available on server")}}),l="discovery_advanced_search_settings";function c(){try{let e=localStorage.getItem(l);if(!e)return null;let t=JSON.parse(e);return{useSearch2:"boolean"==typeof t.useSearch2?t.useSearch2:void 0,hybridWeight:"number"==typeof t.hybridWeight?t.hybridWeight:void 0,maxDistance:"number"==typeof t.maxDistance?t.maxDistance:void 0,maxDistanceMode:"max_distance"===t.maxDistanceMode||"min_score"===t.maxDistanceMode||"both"===t.maxDistanceMode?t.maxDistanceMode:void 0,directMatchWeight:"number"==typeof t.directMatchWeight?t.directMatchWeight:void 0,paginationStrategy:"filter"===t.paginationStrategy||"offset"===t.paginationStrategy||"trust_estimate"===t.paginationStrategy?t.paginationStrategy:void 0}}catch(e){return console.error("Failed to load advanced settings from localStorage:",e),null}}function g(e,t){let o=new URLSearchParams;if(e.debouncedQuery&&""!==e.debouncedQuery.trim()&&o.set("query",e.debouncedQuery.trim()),e.selectedFilters.keywords&&e.selectedFilters.keywords.length>0&&e.selectedFilters.keywords.forEach(e=>o.append("topics",e)),e.selectedFilters.instruments&&e.selectedFilters.instruments.length>0&&e.selectedFilters.instruments.forEach(e=>o.append("instruments",e)),e.selectedFilters.study_design&&e.selectedFilters.study_design.length>0&&e.selectedFilters.study_design.forEach(e=>o.append("study_design",e)),e.selectedFilters.resource_type&&e.selectedFilters.resource_type.length>0&&o.set("resource_type",e.selectedFilters.resource_type[0]),Object.entries(e.selectedFilters).forEach(e=>{let[t,n]=e;!("keywords"===t||"instruments"===t||"study_design"===t||"resource_type"===t||t.includes("#"))&&n&&0!==n.length&&n.forEach(e=>{o.append(t,e)})}),e.useSearch2&&o.set("use_search2","true"),.5!==e.hybridWeight&&o.set("hybrid_weight",e.hybridWeight.toString()),.5!==e.maxDistance&&o.set("max_distance",e.maxDistance.toString()),"both"!==e.maxDistanceMode&&o.set("max_distance_mode",e.maxDistanceMode),.5!==e.directMatchWeight){let t=e.directMatchWeight<=.5?4*e.directMatchWeight:16*e.directMatchWeight-6;o.set("direct_match_weight",t.toString())}"trust_estimate"!==e.paginationStrategy&&o.set("pagination_strategy",e.paginationStrategy),e.selectedCategory&&o.set("category",e.selectedCategory),e.similarUid&&o.set("like",e.similarUid);let n=o.toString();return n?"".concat(t,"?").concat(n):t}function d(e){let t=e.get("query")||"",o=e.getAll("topics"),n=e.getAll("instruments"),a=e.getAll("study_design"),i=e.get("resource_type"),r=e.get("like"),s=e.get("use_search2"),l=e.get("hybrid_weight"),c=e.get("max_distance"),g=e.get("max_distance_mode"),d=e.get("direct_match_weight"),u=e.get("pagination_strategy"),h=e.get("category"),p={};o.length>0&&(p.keywords=o),n.length>0&&(p.instruments=n),a.length>0&&(p.study_design=a),i&&(p.resource_type=[i]);let m=new Set(["query","topics","instruments","study_design","resource_type","like","use_search2","hybrid_weight","max_distance","max_distance_mode","direct_match_weight","pagination_strategy","category"]);return e.forEach((t,o)=>{if(!m.has(o)){let t=e.getAll(o);t.length>0&&(p[o]=t)}}),{query:t,debouncedQuery:t,selectedFilters:p,selectedCategory:h||null,useSearch2:"true"===s,hybridWeight:l?parseFloat(l):.5,maxDistance:c?parseFloat(c):.5,maxDistanceMode:"max_distance"===g||"min_score"===g||"both"===g?g:"both",directMatchWeight:d?(()=>{let e=parseFloat(d);return e<=2?e/4:(e+6)/16})():.5,paginationStrategy:"filter"===u||"offset"===u||"trust_estimate"===u?u:"trust_estimate",resourceType:i||null,similarUid:r||null}}function u(e){let{children:t}=e,o=(0,i.useRouter)(),u=(0,i.usePathname)(),h=(0,i.useSearchParams)(),[p,m]=(0,a.useState)(()=>{{let e=c();if(e)return{...r,...e}}return r}),[y,S]=(0,a.useState)(!1),C=(0,a.useRef)(!0),f=(0,a.useRef)(null),_=(0,a.useRef)("");(0,a.useEffect)(()=>{let e=d(h),t=h.get("query"),o=h.get("topics")||h.get("instruments")||h.get("study_design")||h.get("resource_type")||Array.from(h.keys()).some(e=>!["query","topics","instruments","study_design","resource_type","like","use_search2","hybrid_weight","max_distance","max_distance_mode","direct_match_weight","pagination_strategy","category"].includes(e)),n=h.get("use_search2")||h.get("hybrid_weight")||h.get("max_distance")||h.get("max_distance_mode")||h.get("direct_match_weight")||h.get("pagination_strategy"),a=h.get("category");if(t||o||n||a){var i,s,l,p,y,S,f,b,D,R,M,x;let t=c(),o={...e,useSearch2:n&&h.get("use_search2")?e.useSearch2:null!=(s=null!=(i=null==t?void 0:t.useSearch2)?i:e.useSearch2)?s:r.useSearch2,hybridWeight:n&&h.get("hybrid_weight")?e.hybridWeight:null!=(p=null!=(l=null==t?void 0:t.hybridWeight)?l:e.hybridWeight)?p:r.hybridWeight,maxDistance:n&&h.get("max_distance")?e.maxDistance:null!=(S=null!=(y=null==t?void 0:t.maxDistance)?y:e.maxDistance)?S:r.maxDistance,maxDistanceMode:n&&h.get("max_distance_mode")?e.maxDistanceMode:null!=(b=null!=(f=null==t?void 0:t.maxDistanceMode)?f:e.maxDistanceMode)?b:r.maxDistanceMode,directMatchWeight:n&&h.get("direct_match_weight")?e.directMatchWeight:null!=(R=null!=(D=null==t?void 0:t.directMatchWeight)?D:e.directMatchWeight)?R:r.directMatchWeight,paginationStrategy:n&&h.get("pagination_strategy")?e.paginationStrategy:null!=(x=null!=(M=null==t?void 0:t.paginationStrategy)?M:e.paginationStrategy)?x:r.paginationStrategy};m(e=>{let t={...e,...o};return _.current=g(t,u),t})}else{let e=c();e&&m(t=>({...t,...e})),_.current=u}C.current=!1},[]),(0,a.useEffect)(()=>(f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{m(e=>({...e,debouncedQuery:e.query}))},800),()=>{f.current&&clearTimeout(f.current)}),[p.query]),(0,a.useEffect)(()=>{if(y||C.current||u.startsWith("/studies/")||u.startsWith("/items/"))return;let e=g(p,u);e!==_.current&&(console.log("Updating SEARCH URL to:",e),_.current=e,(0,a.startTransition)(()=>{o.push(e)}))},[p.debouncedQuery,p.selectedFilters,p.useSearch2,p.hybridWeight,p.maxDistance,p.maxDistanceMode,p.directMatchWeight,p.paginationStrategy,p.selectedCategory,p.resourceType,p.similarUid,u,o]),(0,a.useEffect)(()=>{if(y)return;if(C.current){C.current=!1;return}if(u.startsWith("/studies/")||u.startsWith("/items/"))return;let e=d(h),t=e.debouncedQuery||"",o=e.selectedFilters||{};(t!==p.debouncedQuery||JSON.stringify(o)!==JSON.stringify(p.selectedFilters)||e.useSearch2!==p.useSearch2||e.hybridWeight!==p.hybridWeight||e.maxDistance!==p.maxDistance||e.maxDistanceMode!==p.maxDistanceMode||e.directMatchWeight!==p.directMatchWeight||e.paginationStrategy!==p.paginationStrategy||e.selectedCategory!==p.selectedCategory||e.resourceType!==p.resourceType||e.similarUid!==p.similarUid)&&(S(!0),_.current=g({...p,...e},u),m(t=>({...t,...e})),setTimeout(()=>S(!1),100))},[h,u]);let b=(0,a.useCallback)(e=>{m(t=>({...t,query:e}))},[]),D=(0,a.useCallback)(e=>{m(t=>{let o={...t,...e};try{let e={useSearch2:o.useSearch2,hybridWeight:o.hybridWeight,maxDistance:o.maxDistance,maxDistanceMode:o.maxDistanceMode,directMatchWeight:o.directMatchWeight,paginationStrategy:o.paginationStrategy};localStorage.setItem(l,JSON.stringify(e))}catch(e){console.error("Failed to save advanced settings to localStorage:",e)}return o})},[]),R=(0,a.useCallback)(()=>{m(r)},[]),M=(0,a.useCallback)(e=>{var t,o,n,a,i,s,l;m({...r,query:e.query,debouncedQuery:e.query,selectedFilters:e.filters||{},useSearch2:null!=(t=e.useSearch2)?t:r.useSearch2,hybridWeight:null!=(o=e.hybridWeight)?o:r.hybridWeight,maxDistance:null!=(n=e.maxDistance)?n:r.maxDistance,maxDistanceMode:null!=(a=e.maxDistanceMode)?a:r.maxDistanceMode,directMatchWeight:null!=(i=e.directMatchWeight)?i:r.directMatchWeight,paginationStrategy:null!=(s=e.paginationStrategy)?s:r.paginationStrategy,selectedCategory:null!=(l=e.selectedCategory)?l:r.selectedCategory})},[]);return(0,n.jsx)(s.Provider,{value:{searchSettings:p,updateQuery:b,updateSearchSettings:D,resetSearchSettings:R,loadSearchFromSaved:M},children:t})}function h(){return(0,a.useContext)(s)}}}]);