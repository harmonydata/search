"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6417],{28544:(e,t,a)=>{a.d(t,{A:()=>w});var n=a(95155),l=a(94049),r=a(73741),o=a(25635),i=a(1151),s=a(15239),c=a(18844),d=a(37609),u=a(12115),h=a(63082),p=a(2778),m=a(52363),x=a(65036),g=a(75912),b=a(70690),y=a(52277),f=a(77073),v=a(42168);function A(e){let{open:t,onClose:a,data:r,title:s="Debug Data"}=e,c=()=>{navigator.clipboard.writeText(JSON.stringify(r,null,2))};return(0,n.jsxs)(p.A,{open:t,onClose:a,maxWidth:"lg",fullWidth:!0,sx:{"& .MuiDialog-paper":{maxHeight:"90vh",height:"90vh"}},children:[(0,n.jsxs)(m.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:1},children:[(0,n.jsx)(o.A,{variant:"h6",component:"div",children:s}),(0,n.jsxs)(l.default,{children:[(0,n.jsx)(i.A,{onClick:c,size:"small",sx:{mr:1},title:"Copy JSON to clipboard",children:(0,n.jsx)(y.A,{fontSize:"small"})}),(0,n.jsx)(i.A,{onClick:a,size:"small",children:(0,n.jsx)(f.A,{fontSize:"small"})})]})]}),(0,n.jsx)(x.A,{dividers:!0,sx:{p:0,height:"100%"},children:t&&(0,n.jsx)(l.default,{sx:{height:"100%",overflow:"auto","& .w-json-view-container":{backgroundColor:"#fafafa",fontSize:"13px",fontFamily:'"SF Mono", Monaco, "Cascadia Code", "Roboto Mono", Consolas, "Courier New", monospace'}},children:(0,n.jsx)(v.Ay,{value:r,collapsed:2,displayObjectSize:!0,displayDataTypes:!0,enableClipboard:!0,style:{backgroundColor:"#fafafa",padding:"16px"}})})}),(0,n.jsxs)(g.A,{children:[(0,n.jsx)(b.A,{onClick:c,startIcon:(0,n.jsx)(y.A,{}),children:"Copy JSON"}),(0,n.jsx)(b.A,{onClick:a,variant:"contained",children:"Close"})]})]})}function w(e){var t,a,p,m,x,g,b,y,f,v,w,j,C,k,_,S,z,F,I,W,M,D,P,V,T,R,H,O,N,U;let{result:B,isSelected:E,onClick:G,onFindSimilar:J,onReportResult:L}=e,Q=!!(B.ancestors&&B.ancestors.length>0),X=null==(a=B.extra_data)||null==(t=a.resource_type)?void 0:t.includes("variable"),K=null==(m=B.extra_data)||null==(p=m.resource_type)?void 0:p.includes("dataset"),[Z,q]=(0,u.useState)(!1),Y=B,$=B;Q&&(null==(x=B.ancestors)?void 0:x[0])&&($=B.ancestors[0],Y=B),(null==$||null==(g=$.extra_data)?void 0:g.resource_type)||$.dataset_schema&&$.dataset_schema["@type"];let ee=(null==(b=$.dataset_schema)?void 0:b.name)||(null==(y=$.extra_data)?void 0:y.name)||"Unnamed Resource",et=Q&&K?(null==(f=Y.dataset_schema)?void 0:f.description)||(null==(v=Y.extra_data)?void 0:v.description)||"":(null==(w=$.dataset_schema)?void 0:w.description)||(null==(j=$.extra_data)?void 0:j.description)||"",ea=((null==(C=$.dataset_schema)?void 0:C.keywords)||$.topics||[]).filter(e=>"string"==typeof e&&!e.includes("<a title=")&&!e.startsWith("<")),en=null!=(U=null!=(N=null!=(O=null!=(H=null!=(R=Y.num_descendant_variables)?R:null==(k=Y.extra_data)?void 0:k.num_variables)?H:null==(_=Y.extra_data)?void 0:_.number_of_variables)?O:null==(S=Y.dataset_schema)?void 0:S.number_of_variables)?N:null==(F=Y.dataset_schema)||null==(z=F.variableMeasured)?void 0:z.length)?U:0,el=(null==(I=Y.variables_which_matched)?void 0:I.length)||0,er=(null==(W=Y.child_datasets)?void 0:W.length)||0,eo=(null==(M=Y.dataset_schema)?void 0:M.includedInDataCatalog)&&Y.dataset_schema.includedInDataCatalog.length>0,ei=et.length>200?"".concat(et.substring(0,200),"..."):et,es=null,[ec,ed]=(0,u.useState)(!1);(null==(D=$.dataset_schema)?void 0:D.image)&&!ec?es=$.dataset_schema.image:$.thumbnail&&!ec&&(es=$.thumbnail);let eu=(0,u.useMemo)(()=>{var e=(e=>{let t=0;for(let a=0;a<e.length;a++)t=(t<<5)-t+e.charCodeAt(a),t&=t;return Math.abs(t)})(ee);let t=Math.max(80,Math.min(220,(0xff0000&e)>>16)),a=Math.max(80,Math.min(220,(65280&e)>>8)),n=Math.max(80,Math.min(220,255&e));return"rgb(".concat(t,", ").concat(a,", ").concat(n,")")},[ee]),eh=(0,u.useMemo)(()=>(e=>{let t=e.trim();return t&&(t.replace(/^(A|The)\s+/i,"").charAt(0).toUpperCase()||t.charAt(0).toUpperCase())||"?"})(ee),[ee]);return(0,n.jsxs)(l.default,{onClick:G,sx:{cursor:"pointer",display:"flex",width:"100%",bgcolor:E?"rgba(25, 118, 210, 0.08)":"transparent",borderLeft:E?"3px solid":"3px solid transparent",borderRight:E?"3px solid":"3px solid transparent",borderColor:E?"primary.main":"transparent","&:hover":{bgcolor:E?"rgba(25, 118, 210, 0.12)":"rgba(0, 0, 0, 0.02)"}},children:[(0,n.jsxs)(l.default,{sx:{width:120,minHeight:"100%",py:2,flexShrink:1,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",color:"grey.500",background:"transparent",position:"relative"},children:[es&&!ec?(0,n.jsx)(s.default,{src:es,alt:ee,width:100,height:100,style:{objectFit:"contain"},onError:()=>ed(!0),unoptimized:!0}):(0,n.jsx)(r.A,{sx:{width:60,height:60,bgcolor:eu,fontSize:"1.5rem",fontWeight:"bold"},children:eh}),Q&&(0,n.jsxs)(n.Fragment,{children:[X&&(0,n.jsx)(l.default,{sx:{position:"absolute",top:0,right:0,bgcolor:"primary.main",color:"white",borderRadius:"50%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:"bold"},children:"V"}),K&&(0,n.jsx)(l.default,{sx:{position:"absolute",top:0,right:0,bgcolor:"primary.main",color:"white",borderRadius:"50%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:"bold"},children:(0,n.jsx)(c.A,{size:16})})]})]}),(0,n.jsxs)(l.default,{sx:{display:"flex",flexDirection:"column",p:2,flex:1,background:"transparent"},children:[(0,n.jsxs)(l.default,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,n.jsx)(o.A,{variant:"h6",gutterBottom:!0,sx:{mb:.5,overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",lineHeight:1.2,flex:1,mr:1},children:ee}),(0,n.jsx)(i.A,{size:"small",onClick:e=>{e.stopPropagation(),L?L():q(!0)},sx:{opacity:.6,"&:hover":{opacity:1},color:"text.secondary"},title:L?"Report search result issue":"Debug data",children:(0,n.jsx)(d.A,{size:16})})]}),ea.length>0&&(0,n.jsx)(o.A,{variant:"body2",sx:{mb:1,color:"text.secondary"},children:ea.slice(0,5).map((e,t)=>(0,n.jsxs)(l.default,{component:"span",children:[(0,n.jsx)(l.default,{component:"strong",sx:{fontSize:{xs:"0.75rem",sm:"0.85rem"}},children:e}),t<Math.min(ea.length,5)-1&&(0,n.jsx)(l.default,{component:"span",sx:{mx:.5},children:"â€¢"})]},"".concat(e,"-").concat(t)))}),(0,n.jsx)(o.A,{variant:"body2",color:"text.secondary",sx:{display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",overflow:"hidden",lineHeight:1.4,mb:1.5},children:ei}),(0,n.jsx)(l.default,{sx:{display:"flex",flexWrap:"wrap",gap:1,mt:"auto"},children:Q&&X?(0,n.jsx)(h.A,{chipVariant:"primary",size:"small",children:(null==(P=Y.extra_data)?void 0:P.description)||(null==(V=Y.extra_data)?void 0:V.name)},null==(T=Y.extra_data)?void 0:T.uuid):(0,n.jsxs)(n.Fragment,{children:[en>0&&(0,n.jsx)(h.A,{chipVariant:"primary",size:"small",children:el>0?"Matched by variable":"".concat(en," Variables")}),eo&&(0,n.jsx)(h.A,{chipVariant:"secondary",size:"small",children:"Data Available"}),er>0&&(0,n.jsxs)(h.A,{chipVariant:"secondary",size:"small",sx:{backgroundColor:"#444653",color:"white","&:hover":{backgroundColor:"#3a3d47"}},children:[er," Dataset",1!==er?"s":""]}),Y.hasFreeAccess&&(0,n.jsx)(h.A,{chipVariant:"secondary",size:"small",children:"Free Access"}),Y.hasCohortsAvailable&&(0,n.jsx)(h.A,{chipVariant:"secondary",size:"small",children:"Cohorts Available"})]})})]}),(0,n.jsx)(A,{open:Z,onClose:()=>q(!1),data:Y,title:"Debug: ".concat(ee)})]})}},63082:(e,t,a)=>{a.d(t,{A:()=>l});var n=a(70690);let l=(0,a(48116).Ay)(n.A,{shouldForwardProp:e=>"chipVariant"!==e})(e=>{let{theme:t,chipVariant:a="primary",onClick:n=()=>{}}=e;return{onClick:n,borderRadius:8,textTransform:"none",padding:"0 16px",height:32,minHeight:32,fontSize:"0.875rem",fontWeight:500,whiteSpace:"nowrap",lineHeight:1,..."primary"===a&&{backgroundColor:t.palette.primary.main,color:t.palette.primary.contrastText,"&:hover":{backgroundColor:t.palette.primary.dark}},..."secondary"===a&&{backgroundColor:t.palette.secondary.main,color:t.palette.secondary.contrastText,"&:hover":{backgroundColor:t.palette.secondary.dark}},..."dark"===a&&{backgroundColor:"#444653",color:"#FFFFFF","&:hover":{backgroundColor:"#363742"}}}})},65380:(e,t,a)=>{a.d(t,{A:()=>s,AuthProvider:()=>c});var n=a(95155),l=a(12115);let r=null,o=async()=>{if(r)return r;console.log("\uD83D\uDD0D Loading Firebase modules dynamically");let[{auth:e},{GithubAuthProvider:t,TwitterAuthProvider:n,GoogleAuthProvider:l,signInWithPopup:o,signInWithEmailAndPassword:i,createUserWithEmailAndPassword:s,sendPasswordResetEmail:c,signOut:d,onAuthStateChanged:u}]=await Promise.all([Promise.all([a.e(9895),a.e(2154),a.e(9820),a.e(1182),a.e(2691)]).then(a.bind(a,68464)),Promise.all([a.e(9895),a.e(9820),a.e(1182)]).then(a.bind(a,33885))]);return r={auth:e,GithubAuthProvider:t,TwitterAuthProvider:n,GoogleAuthProvider:l,signInWithPopup:o,signInWithEmailAndPassword:i,createUserWithEmailAndPassword:s,sendPasswordResetEmail:c,signOut:d,onAuthStateChanged:u}},i=(0,l.createContext)({currentUser:null,isAdmin:!1,login:async()=>(console.warn("Auth not available on server"),null),signup:async()=>(console.warn("Auth not available on server"),null),logout:async()=>{console.warn("Auth not available on server")},resetPassword:async()=>{console.warn("Auth not available on server")},signInWithGoogle:async()=>(console.warn("Auth not available on server"),null),signInWithGitHub:async()=>(console.warn("Auth not available on server"),null),signInWithTwitter:async()=>(console.warn("Auth not available on server"),null),loading:!1});function s(){return(0,l.useContext)(i)}function c(e){let{children:t}=e,[r,s]=(0,l.useState)(null),[c,d]=(0,l.useState)(!1),[u,h]=(0,l.useState)(!0),[p,m]=(0,l.useState)(!1);(0,l.useEffect)(()=>{(async()=>{try{let{auth:e,onAuthStateChanged:t}=await o();if(!e){console.warn("Firebase auth not available"),h(!1);return}return m(!0),t(e,async e=>{if(console.log("\uD83D\uDD04 Auth state changed:",{hasUser:!!e,uid:null==e?void 0:e.uid,SSR:!1}),s(e),null==e?void 0:e.uid){console.log("\uD83D\uDD10 AuthContext: User logged in, checking admin status for UID:",e.uid);try{let{isAdmin:t}=await Promise.all([a.e(9895),a.e(2154),a.e(9820),a.e(1182),a.e(7234)]).then(a.bind(a,99703));console.log("\uD83D\uDD10 AuthContext: Admin check function loaded, calling...");let n=await t(e.uid);console.log("\uD83D\uDD10 AuthContext: Admin check completed, result:",n),d(n)}catch(e){console.error("\uD83D\uDD10 AuthContext: Failed to check admin status:",e),d(!1)}}else console.log("\uD83D\uDD10 AuthContext: No user, setting isAdmin to false"),d(!1);h(!1)})}catch(e){console.error("Failed to load Firebase modules:",e),h(!1)}})()},[]);let x={currentUser:r,isAdmin:c,...l.useMemo(()=>{let e=async e=>{let{auth:t,signInWithPopup:a}=await o();return a(t,e).then(e=>e.user).catch(t=>e.credentialFromError(t))};return{login:async(e,t)=>{let{auth:a,signInWithEmailAndPassword:n}=await o();return n(a,e,t)},signup:async(e,t)=>{let{auth:a,createUserWithEmailAndPassword:n}=await o();return n(a,e,t)},logout:async()=>{let{auth:e,signOut:t}=await o();return t(e)},resetPassword:async e=>{let{auth:t,sendPasswordResetEmail:a}=await o();return a(t,e)},signInWithGoogle:async()=>{let{GoogleAuthProvider:t}=await o();return e(new t)},signInWithGitHub:async()=>{let{GithubAuthProvider:t}=await o();return e(new t)},signInWithTwitter:async()=>{let{TwitterAuthProvider:t}=await o();return e(new t)}}},[]),loading:u};return(0,n.jsx)(i.Provider,{value:x,children:t})}},95465:(e,t,a)=>{a.r(t),a.d(t,{app:()=>o,auth:()=>i,db:()=>s});var n=a(52078),l=a(33885),r=a(65705);let o=(0,n.Wp)({apiKey:"AIzaSyBQVkRjbTQD6BXCdo2JeiFfwyvGVT7bOXM",authDomain:"harmony-6bd51.firebaseapp.com",projectId:"harmony-6bd51",storageBucket:"harmony-6bd51.appspot.com",messagingSenderId:"914732561143",appId:"1:914732561143:web:b041f0c5e7fab57400d9f2",measurementId:"G-S79J6E39ZP"}),i=(0,l.getAuth)(o),s=(0,r.getFirestore)(o)}}]);