"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6417],{28544:(e,t,a)=>{a.d(t,{A:()=>C});var n=a(95155),l=a(33567),r=a(15712),o=a(94049),i=a(73741),s=a(25635),d=a(1151),c=a(15239),u=a(18844),h=a(37609),m=a(12115),x=a(63082),p=a(2778),g=a(52363),b=a(65036),y=a(75912),f=a(70690),v=a(52277),A=a(77073),w=a(42168);function j(e){let{open:t,onClose:a,data:l,title:r="Debug Data"}=e,i=()=>{navigator.clipboard.writeText(JSON.stringify(l,null,2))};return(0,n.jsxs)(p.A,{open:t,onClose:a,maxWidth:"lg",fullWidth:!0,sx:{"& .MuiDialog-paper":{maxHeight:"90vh",height:"90vh"}},children:[(0,n.jsxs)(g.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:1},children:[(0,n.jsx)(s.A,{variant:"h6",component:"div",children:r}),(0,n.jsxs)(o.default,{children:[(0,n.jsx)(d.A,{onClick:i,size:"small",sx:{mr:1},title:"Copy JSON to clipboard",children:(0,n.jsx)(v.A,{fontSize:"small"})}),(0,n.jsx)(d.A,{onClick:a,size:"small",children:(0,n.jsx)(A.A,{fontSize:"small"})})]})]}),(0,n.jsx)(b.A,{dividers:!0,sx:{p:0,height:"100%"},children:t&&(0,n.jsx)(o.default,{sx:{height:"100%",overflow:"auto","& .w-json-view-container":{backgroundColor:"#fafafa",fontSize:"13px",fontFamily:'"SF Mono", Monaco, "Cascadia Code", "Roboto Mono", Consolas, "Courier New", monospace'}},children:(0,n.jsx)(w.Ay,{value:l,collapsed:2,displayObjectSize:!0,displayDataTypes:!0,enableClipboard:!0,style:{backgroundColor:"#fafafa",padding:"16px"}})})}),(0,n.jsxs)(y.A,{children:[(0,n.jsx)(f.A,{onClick:i,startIcon:(0,n.jsx)(v.A,{}),children:"Copy JSON"}),(0,n.jsx)(f.A,{onClick:a,variant:"contained",children:"Close"})]})]})}function C(e){var t,a,p,g,b,y,f,v,A,w,C,k,_,S,z,F,I,W,M,D,P,V,T,H,R,O,N,U,B,E;let{result:G,isSelected:J,onClick:L,onFindSimilar:Q,onReportResult:X}=e,K=!!(G.ancestors&&G.ancestors.length>0),Z=null==(a=G.extra_data)||null==(t=a.resource_type)?void 0:t.includes("variable"),q=null==(g=G.extra_data)||null==(p=g.resource_type)?void 0:p.includes("dataset"),[Y,$]=(0,m.useState)(!1),ee=G,et=G;K&&(null==(b=G.ancestors)?void 0:b[0])&&(et=G.ancestors[0],ee=G),(null==et||null==(y=et.extra_data)?void 0:y.resource_type)||et.dataset_schema&&et.dataset_schema["@type"];let ea=(null==(f=et.dataset_schema)?void 0:f.name)||(null==(v=et.extra_data)?void 0:v.name)||"Unnamed Resource",en=K&&q?(null==(A=ee.dataset_schema)?void 0:A.description)||(null==(w=ee.extra_data)?void 0:w.description)||"":(null==(C=et.dataset_schema)?void 0:C.description)||(null==(k=et.extra_data)?void 0:k.description)||"",el=((null==(_=et.dataset_schema)?void 0:_.keywords)||et.topics||[]).filter(e=>"string"==typeof e&&!e.includes("<a title=")&&!e.startsWith("<")),er=null!=(E=null!=(B=null!=(U=null!=(N=null!=(O=ee.num_descendant_variables)?O:null==(S=ee.extra_data)?void 0:S.num_variables)?N:null==(z=ee.extra_data)?void 0:z.number_of_variables)?U:null==(F=ee.dataset_schema)?void 0:F.number_of_variables)?B:null==(W=ee.dataset_schema)||null==(I=W.variableMeasured)?void 0:I.length)?E:0,eo=(null==(M=ee.variables_which_matched)?void 0:M.length)||0,ei=(null==(D=ee.child_datasets)?void 0:D.length)||0,es=(null==(P=ee.dataset_schema)?void 0:P.includedInDataCatalog)&&ee.dataset_schema.includedInDataCatalog.length>0,ed=en.length>200?"".concat(en.substring(0,200),"..."):en,ec=null,[eu,eh]=(0,m.useState)(!1);(null==(V=et.dataset_schema)?void 0:V.image)&&!eu?ec=et.dataset_schema.image:et.thumbnail&&!eu&&(ec=et.thumbnail);let em=(0,m.useMemo)(()=>{var e=(e=>{let t=0;for(let a=0;a<e.length;a++)t=(t<<5)-t+e.charCodeAt(a),t&=t;return Math.abs(t)})(ea);let t=Math.max(80,Math.min(220,(0xff0000&e)>>16)),a=Math.max(80,Math.min(220,(65280&e)>>8)),n=Math.max(80,Math.min(220,255&e));return"rgb(".concat(t,", ").concat(a,", ").concat(n,")")},[ea]),ex=(0,m.useMemo)(()=>(e=>{let t=e.trim();return t&&(t.replace(/^(A|The)\s+/i,"").charAt(0).toUpperCase()||t.charAt(0).toUpperCase())||"?"})(ea),[ea]),ep=(0,l.A)(),eg=(0,r.A)(ep.breakpoints.down("sm"));return(0,n.jsxs)(o.default,{onClick:L,sx:{cursor:"pointer",display:"flex",width:"100%",bgcolor:J?"rgba(25, 118, 210, 0.08)":"transparent",borderLeft:J?"3px solid":"3px solid transparent",borderRight:J?"3px solid":"3px solid transparent",borderColor:J?"primary.main":"transparent","&:hover":{bgcolor:J?"rgba(25, 118, 210, 0.12)":"rgba(0, 0, 0, 0.02)"}},children:[(0,n.jsxs)(o.default,{sx:{width:{xs:100,sm:120},height:{xs:100,sm:"auto"},minHeight:{xs:100,sm:"100%"},py:{xs:1,sm:2},flexShrink:0,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",color:"grey.500",background:"transparent",position:"relative"},children:[ec&&!eu?(0,n.jsx)(c.default,{src:ec,alt:ea,width:eg?80:100,height:eg?80:100,style:{objectFit:"contain",maxWidth:"100%",maxHeight:"100%"},onError:()=>eh(!0),unoptimized:!0}):(0,n.jsx)(i.A,{sx:{width:{xs:50,sm:60},height:{xs:50,sm:60},bgcolor:em,fontSize:{xs:"1.25rem",sm:"1.5rem"},fontWeight:"bold"},children:ex}),K&&(0,n.jsxs)(n.Fragment,{children:[Z&&(0,n.jsx)(o.default,{sx:{position:"absolute",top:0,right:0,bgcolor:"primary.main",color:"white",borderRadius:"50%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:"bold"},children:"V"}),q&&(0,n.jsx)(o.default,{sx:{position:"absolute",top:0,right:0,bgcolor:"primary.main",color:"white",borderRadius:"50%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:"bold"},children:(0,n.jsx)(u.A,{size:16})})]})]}),(0,n.jsxs)(o.default,{sx:{display:"flex",flexDirection:"column",p:2,flex:1,background:"transparent"},children:[(0,n.jsxs)(o.default,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,n.jsx)(s.A,{variant:"h6",gutterBottom:!0,sx:{mb:.5,overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",lineHeight:1.2,flex:1,mr:1},children:ea}),(0,n.jsx)(d.A,{size:"small",onClick:e=>{e.stopPropagation(),X?X():$(!0)},sx:{opacity:.6,"&:hover":{opacity:1},color:"text.secondary"},title:X?"Report search result issue":"Debug data",children:(0,n.jsx)(h.A,{size:16})})]}),el.length>0&&(0,n.jsx)(s.A,{variant:"body2",sx:{mb:1,color:"text.secondary"},children:el.slice(0,5).map((e,t)=>(0,n.jsxs)(o.default,{component:"span",children:[(0,n.jsx)(o.default,{component:"strong",sx:{fontSize:{xs:"0.75rem",sm:"0.85rem"}},children:e}),t<Math.min(el.length,5)-1&&(0,n.jsx)(o.default,{component:"span",sx:{mx:.5},children:"â€¢"})]},"".concat(e,"-").concat(t)))}),(0,n.jsx)(s.A,{variant:"body2",color:"text.secondary",sx:{display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",overflow:"hidden",lineHeight:1.4,mb:1.5},children:ed}),(0,n.jsx)(o.default,{sx:{display:"flex",flexWrap:"wrap",gap:1,mt:"auto"},children:K&&Z?(0,n.jsx)(x.A,{chipVariant:"primary",size:"small",children:(null==(T=ee.extra_data)?void 0:T.description)||(null==(H=ee.extra_data)?void 0:H.name)},null==(R=ee.extra_data)?void 0:R.uuid):(0,n.jsxs)(n.Fragment,{children:[er>0&&(0,n.jsx)(x.A,{chipVariant:"primary",size:"small",children:eo>0?"Matched by variable":"".concat(er," Variables")}),es&&(0,n.jsx)(x.A,{chipVariant:"secondary",size:"small",children:"Data Available"}),ei>0&&(0,n.jsxs)(x.A,{chipVariant:"secondary",size:"small",sx:{backgroundColor:"#444653",color:"white","&:hover":{backgroundColor:"#3a3d47"}},children:[ei," Dataset",1!==ei?"s":""]}),ee.hasFreeAccess&&(0,n.jsx)(x.A,{chipVariant:"secondary",size:"small",children:"Free Access"}),ee.hasCohortsAvailable&&(0,n.jsx)(x.A,{chipVariant:"secondary",size:"small",children:"Cohorts Available"})]})})]}),(0,n.jsx)(j,{open:Y,onClose:()=>$(!1),data:ee,title:"Debug: ".concat(ea)})]})}},63082:(e,t,a)=>{a.d(t,{A:()=>l});var n=a(70690);let l=(0,a(48116).Ay)(n.A,{shouldForwardProp:e=>"chipVariant"!==e})(e=>{let{theme:t,chipVariant:a="primary",onClick:n=()=>{}}=e;return{onClick:n,borderRadius:8,textTransform:"none",padding:"0 16px",height:32,minHeight:32,fontSize:"0.875rem",fontWeight:500,whiteSpace:"nowrap",lineHeight:1,..."primary"===a&&{backgroundColor:t.palette.primary.main,color:t.palette.primary.contrastText,"&:hover":{backgroundColor:t.palette.primary.dark}},..."secondary"===a&&{backgroundColor:t.palette.secondary.main,color:t.palette.secondary.contrastText,"&:hover":{backgroundColor:t.palette.secondary.dark}},..."dark"===a&&{backgroundColor:"#444653",color:"#FFFFFF","&:hover":{backgroundColor:"#363742"}}}})},65380:(e,t,a)=>{a.d(t,{A:()=>s,AuthProvider:()=>d});var n=a(95155),l=a(12115);let r=null,o=async()=>{if(r)return r;console.log("\uD83D\uDD0D Loading Firebase modules dynamically");let[{auth:e},{GithubAuthProvider:t,TwitterAuthProvider:n,GoogleAuthProvider:l,signInWithPopup:o,signInWithEmailAndPassword:i,createUserWithEmailAndPassword:s,sendPasswordResetEmail:d,signOut:c,onAuthStateChanged:u}]=await Promise.all([Promise.all([a.e(9895),a.e(2154),a.e(9820),a.e(1182),a.e(2691)]).then(a.bind(a,68464)),Promise.all([a.e(9895),a.e(9820),a.e(1182)]).then(a.bind(a,33885))]);return r={auth:e,GithubAuthProvider:t,TwitterAuthProvider:n,GoogleAuthProvider:l,signInWithPopup:o,signInWithEmailAndPassword:i,createUserWithEmailAndPassword:s,sendPasswordResetEmail:d,signOut:c,onAuthStateChanged:u}},i=(0,l.createContext)({currentUser:null,isAdmin:!1,login:async()=>(console.warn("Auth not available on server"),null),signup:async()=>(console.warn("Auth not available on server"),null),logout:async()=>{console.warn("Auth not available on server")},resetPassword:async()=>{console.warn("Auth not available on server")},signInWithGoogle:async()=>(console.warn("Auth not available on server"),null),signInWithGitHub:async()=>(console.warn("Auth not available on server"),null),signInWithTwitter:async()=>(console.warn("Auth not available on server"),null),loading:!1});function s(){return(0,l.useContext)(i)}function d(e){let{children:t}=e,[r,s]=(0,l.useState)(null),[d,c]=(0,l.useState)(!1),[u,h]=(0,l.useState)(!0),[m,x]=(0,l.useState)(!1);(0,l.useEffect)(()=>{(async()=>{try{let{auth:e,onAuthStateChanged:t}=await o();if(!e){console.warn("Firebase auth not available"),h(!1);return}return x(!0),t(e,async e=>{if(console.log("\uD83D\uDD04 Auth state changed:",{hasUser:!!e,uid:null==e?void 0:e.uid,SSR:!1}),s(e),null==e?void 0:e.uid){console.log("\uD83D\uDD10 AuthContext: User logged in, checking admin status for UID:",e.uid);try{let{isAdmin:t}=await Promise.all([a.e(9895),a.e(2154),a.e(9820),a.e(1182),a.e(7234)]).then(a.bind(a,99703));console.log("\uD83D\uDD10 AuthContext: Admin check function loaded, calling...");let n=await t(e.uid);console.log("\uD83D\uDD10 AuthContext: Admin check completed, result:",n),c(n)}catch(e){console.error("\uD83D\uDD10 AuthContext: Failed to check admin status:",e),c(!1)}}else console.log("\uD83D\uDD10 AuthContext: No user, setting isAdmin to false"),c(!1);h(!1)})}catch(e){console.error("Failed to load Firebase modules:",e),h(!1)}})()},[]);let p={currentUser:r,isAdmin:d,...l.useMemo(()=>{let e=async e=>{let{auth:t,signInWithPopup:a}=await o();return a(t,e).then(e=>e.user).catch(t=>e.credentialFromError(t))};return{login:async(e,t)=>{let{auth:a,signInWithEmailAndPassword:n}=await o();return n(a,e,t)},signup:async(e,t)=>{let{auth:a,createUserWithEmailAndPassword:n}=await o();return n(a,e,t)},logout:async()=>{let{auth:e,signOut:t}=await o();return t(e)},resetPassword:async e=>{let{auth:t,sendPasswordResetEmail:a}=await o();return a(t,e)},signInWithGoogle:async()=>{let{GoogleAuthProvider:t}=await o();return e(new t)},signInWithGitHub:async()=>{let{GithubAuthProvider:t}=await o();return e(new t)},signInWithTwitter:async()=>{let{TwitterAuthProvider:t}=await o();return e(new t)}}},[]),loading:u};return(0,n.jsx)(i.Provider,{value:p,children:t})}},95465:(e,t,a)=>{a.r(t),a.d(t,{app:()=>o,auth:()=>i,db:()=>s});var n=a(52078),l=a(33885),r=a(65705);let o=(0,n.Wp)({apiKey:"AIzaSyBQVkRjbTQD6BXCdo2JeiFfwyvGVT7bOXM",authDomain:"harmony-6bd51.firebaseapp.com",projectId:"harmony-6bd51",storageBucket:"harmony-6bd51.appspot.com",messagingSenderId:"914732561143",appId:"1:914732561143:web:b041f0c5e7fab57400d9f2",measurementId:"G-S79J6E39ZP"}),i=(0,l.getAuth)(o),s=(0,r.getFirestore)(o)}}]);